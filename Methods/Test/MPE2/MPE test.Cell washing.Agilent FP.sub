// {{{ 2 "SubmethodForwardDeclaration" ""
private function CleanUp(  ) void ;
private function GetParams(  ) void ;
private function Request_MPE2_Params( variable & UserControlPts ) void ;
private function StartUp(  ) void ;
function OnAbort(  ) void ;
// }} ""
// {{{ 5 "OnAbort" "Begin"
function OnAbort(  ) void {
// }} ""
// {{ 5 "OnAbort" "InitLocals"
// }} ""
// {{ 90 1 0 "02908560_3b91_4dfe_a7ccd74dde218802" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************************\nRunning OnAbort()\n************************************************"));
// }} ""
// {{{ 91 1 0 "5a222cc3_a8ad_4416_895f37076c64f14b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CleanUp();
// }} ""
// {{{ 5 "OnAbort" "End"
}
// }} ""
// {{{ 5 "GetParams" "Begin"
private function GetParams(  ) void {
// }} ""
// {{ 5 "GetParams" "InitLocals"
// }} ""
// {{ 36 1 0 "56123cde_5c09_4b41_a7eb91807363cad9" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************************\nRunning GetParams()\n************************************************"));
// }} ""
// {{ 37 1 0 "07f337da_c512_4c93_b659b9af37ec23ce" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 38 1 0 "b19827dd_8d7d_4c74_899a1aa2b68faadf" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 39 1 0 "1b5bf3f0_90f6_43a5_90b2ccbbbf26d5d1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 40 1 0 "3b06ad74_1669_4d92_94bbe0eb3c62f67d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
MPE2COMPort = 7;
// }} ""
// {{{ 41 1 0 "170571e5_cd90_413b_9636375e411d6425" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("MPE2COMPort = "), MPE2COMPort);
// }} ""
// {{ 42 1 0 "b19827dd_8d7d_4c74_899a1aa2b68faadf" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 43 1 0 "d935108e_dcf6_4ca7_aaa862c00ab0e916" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 44 1 0 "6c26f797_ccf7_4722_92cde66fa246a712" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPonRPNozzleHeight = 87.0;
// }} ""
// {{ 45 1 0 "ff8dfdf9_3bc7_4d70_b557d1aa35c356a1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPonRPFilterHeight = 87.0;
// }} ""
// {{ 46 1 0 "d935108e_dcf6_4ca7_aaa862c00ab0e916" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 47 1 0 "61c89713_6a39_4f50_ad65dc2a6916a739" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 48 1 0 "9d4b7bdf_7270_496a_b0ff78224deb3f83" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPonAbgeneRPNozzleHeight = 66.0;
// }} ""
// {{ 49 1 0 "3322478a_3137_4baf_a705b9c5aae7d7d0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPonAbgeneRPFilterHeight = 66.0;
// }} ""
// {{ 50 1 0 "61c89713_6a39_4f50_ad65dc2a6916a739" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 51 1 0 "926a1ee1_37a8_457e_93cb60a20d0ae0c0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 52 1 0 "4f306a42_e06b_43e4_b6c9e095c07aac8f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPNozzleHeight = 47.5;
// }} ""
// {{ 53 1 0 "deee3bde_d9c3_4403_a9793c8c69d5e2f7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPFilterHeight = 44.0;
// }} ""
// {{ 54 1 0 "6e575a56_9fc9_4536_95b48a202f69dbf6" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
FPNozzleOffset = 0;
// }} ""
// {{ 55 1 0 "926a1ee1_37a8_457e_93cb60a20d0ae0c0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 56 1 0 "1203ad77_ad53_48d9_b4388025156bf4fb" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 57 1 0 "5602ba0d_c9c9_4b39_a3a51ba8d4b536db" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
MPE2Waste = 0;
// }} ""
// {{ 58 1 0 "07f337da_c512_4c93_b659b9af37ec23ce" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 59 1 0 "7f3907a8_25a2_4f79_b2f17cd7834f516e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************\nEnd Definitions\n************************************"));
// }} ""
// {{{ 5 "GetParams" "End"
}
// }} ""
// {{{ 5 "StartUp" "Begin"
private function StartUp(  ) void {
// }} ""
private variable SimMode;
private variable MPE2Return;
// {{ 5 "StartUp" "InitLocals"
// }} ""
// {{ 73 1 0 "9db08e78_0a80_4e35_94660d2e51844152" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************************\nRunning StartUp()\n************************************************"));
// }} ""
// {{ 74 1 0 "907e5233_7d8d_40d1_9d48945da4644870" "ML_STAR:{1C0C0CB0-7C87-11D3-AD83-0004ACB1DCB2}"
{
	variable arrRetValues[];
	arrRetValues = ML_STAR._1C0C0CB0_7C87_11D3_AD83_0004ACB1DCB2("907e5233_7d8d_40d1_9d48945da4644870"); // Initialize
}
// }} ""
// {{ 75 1 0 "de3c6926_74a9_4cfa_87f74dbf7fbaf14e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 76 1 0 "51f1f5c0_eed7_41bf_bca5d7cd118892da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (_blnSimulationMode == 1)
{
// }} ""
// {{ 77 1 0 "b37e42ff_f025_425b_9e4b7361103a4796" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
SimMode = 1;
// }} ""
// {{{ 78 1 0 "c210d6d0_3ed5_459a_ba7f5ae8c9a58af6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("SiimMod = "), SimMode);
// }} ""
// {{ 79 1 0 "51f1f5c0_eed7_41bf_bca5d7cd118892da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 80 1 0 "c55a1eb7_6daf_49a9_9d995800881da9a7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
SimMode = 0;
// }} ""
// {{{ 81 1 0 "9f2f42c3_7f78_4ccf_ab04450bcce20d3e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("SiimMod = "), SimMode);
// }} ""
// {{{ 82 1 0 "d4d0dfb8_5268_49f1_8cc7a2385600107d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
MPE_LIBRARY::InitializeMPELibrary(_blnSimulationMode);
// }} ""
// {{ 83 1 0 "bfb5ad67_e038_4a52_8c642f6f3221a42f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 84 1 0 "faf74101_fe8e_4c3c_8a7f9e7dc49d154a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
MPE2Return = MPE_LIBRARY::Connect(0);
// }} ""
// {{ 85 1 0 "56ced785_d152_4ce9_af31397abf62df14" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 86 1 0 "2634b58c_d3c2_430b_a428c7ac71473fd1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
MPE2Return = MPE_LIBRARY::Initialize(0);
// }} ""
// {{ 87 1 0 "51f1f5c0_eed7_41bf_bca5d7cd118892da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 88 1 0 "5160f9af_c3c1_4b21_9a07ce28b0c2ae45" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************\nEnd Startup\n************************************"));
// }} ""
// {{{ 5 "StartUp" "End"
}
// }} ""
// {{{ 5 "CleanUp" "Begin"
private function CleanUp(  ) void {
// }} ""
// {{ 5 "CleanUp" "InitLocals"
// }} ""
// {{ 27 1 0 "c1295d94_5b99_40bf_a2a6bfa87becb3d8" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************************\nRunning CleanUp()\n************************************************"));
// }} ""
// {{ 28 1 0 "90f760b3_5145_4ece_98dcf1adf7f8d136" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (_blnSimulationMode == 1)
{
// }} ""
// {{ 29 1 0 "3c58b153_8313_410d_9b00cf81a27c40a7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("---------------------------------------------------------------------------------------------------------\nSimulation Mode: Venus is pretending to make the MPE2 disconnect\n---------------------------------------------------------------------------------------------------------"));
// }} ""
// {{ 30 1 0 "90f760b3_5145_4ece_98dcf1adf7f8d136" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 31 1 0 "b6ab7649_59e3_4fc7_b77522f61ccf28cc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
MPE_LIBRARY::Disconnect(0);
// }} ""
// {{ 32 1 0 "90f760b3_5145_4ece_98dcf1adf7f8d136" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 33 1 0 "a8f9596c_42ca_48ee_a921f492894043c4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMON96HEADSUBMETHODS::Clear96HeadAndArm(ML_STAR);
// }} ""
// {{ 34 1 0 "89512189_ba57_4270_b55d8041e46acb5f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************\nEnd Cleanup\n************************************"));
// }} ""
// {{{ 5 "CleanUp" "End"
}
// }} ""
// {{{ 5 "Request_MPE2_Params" "Begin"
private function Request_MPE2_Params( variable & UserControlPts ) void {
// }} ""
private dialog dialogHandleAA39145F48DC4305913B203B444531A5;
private variable PressureStr;
private variable Pressure;
private variable TimeStr;
private variable Time;
// {{ 5 "Request_MPE2_Params" "InitLocals"
UserControlPts = 0;
// }} ""
// {{ 61 1 0 "2e3378e7_93b3_440a_bf61040d5cbfb846" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************\nStart user input submethod\n************************************"));
// }} ""
// {{ 62 1 0 "b85dbc07_bcbc_408f_a55aeacf3882869f" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandleAA39145F48DC4305913B203B444531A5.SetInputSize(2);
dialogHandleAA39145F48DC4305913B203B444531A5.SetInputField(0, Translate("Enter pressure (psi): "), hslInteger, 0, 0, 100);
dialogHandleAA39145F48DC4305913B203B444531A5.SetInputField(1, Translate("Enter duration (s): "), hslInteger, 0, 0, 1000000);
dialogHandleAA39145F48DC4305913B203B444531A5.ShowInput(Translate("Enter [MPE]2 parameters"), hslInfinite, hslOKOnly | hslDefButton1);
Pressure = dialogHandleAA39145F48DC4305913B203B444531A5.GetInputField(0);
Time = dialogHandleAA39145F48DC4305913B203B444531A5.GetInputField(1);
// }} ""
// {{ 63 1 0 "fe8794f0_13d2_4ab2_b6fc16f7f00a8ef5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("Convert entered integer variables for Pressure and Time to strings"));
// }} ""
// {{{ 64 1 0 "df090cae_61cc_4a6a_a2589969fde2e554" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
PressureStr = StrIStr(Pressure);
// }} ""
// {{{ 65 1 0 "be66693c_b2f7_43a0_8f8d3c26bb96e21c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TimeStr = StrIStr(Time);
// }} ""
// {{ 66 1 0 "4c2ceaad_7f44_4bab_93fa93ec62c893f9" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("Assign \"UserControlPts\" string for [MPE]2 processing step: type (pressure), value (PressureStr), duration (TimeStr)"));
// }} ""
// {{ 67 1 0 "7978d2cb_10be_408b_9f4026b8a810bfb5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
UserControlPts = Translate("pressure,");
// }} ""
// {{ 68 1 0 "b39631d9_6c1a_4d72_bab750e3fe44860f" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
UserControlPts = UserControlPts + PressureStr;
// }} ""
// {{ 69 1 0 "8320af69_8ea6_46c8_8d07c3455062dcc7" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
UserControlPts = UserControlPts + Translate(",");
// }} ""
// {{ 70 1 0 "b5b4588e_234a_48b5_9d29a51a3d7e7493" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
UserControlPts = UserControlPts + TimeStr;
// }} ""
// {{ 71 1 0 "9c958ccc_bfcd_4b81_822253407a0ebc09" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("************************************\nEnd user input submethod\n************************************"));
// }} ""
// {{{ 5 "Request_MPE2_Params" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// $$author=Hamilton$$valid=0$$time=2020-07-28 12:28$$checksum=e14cc8ab$$length=087$$