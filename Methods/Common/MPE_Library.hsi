// {{{ 2 "IncludeGuard" "PragmaOnce"
#pragma once
// }} ""
#include "HSLMPELib.hsl"
#include "HSLTrcLib.hsl"
/* {{ 2 "LibraryInsertLine" "" */ // }} ""
// {{ 2 "TemplateIncludeBlock" ""
#include "HSLMETEDLib.hs_"
#include "HSLMECCLib.hs_"
// }} ""
// {{{ 2 "LibraryNamespace" "Begin"
namespace MPE_LIBRARY {
// }} ""
variable comPort;
variable MPE2DevID;
variable baudRate;
variable blnMPEVacuumCheck;
variable filterHeight;
variable nozzleHeight;
variable offsetFromNozzles;
variable collectionPlateHeight;
variable controlPoints;
variable wasteContainerID;
variable _blnSimulationMode;
/* {{ 2 "VariableInsertLine" "" */ // }} ""
// {{{ 2 "SubmethodForwardDeclaration" ""
function ClampFilterPlate( variable useAutoErrorRecovery ) variable ;
function CollectionPlatePlaced( variable useAutoErrorRecovery ) variable ;
function CollectionPlateRemoved( variable useAutoErrorRecovery ) variable ;
function Connect( variable useAutoErrorRecovery ) variable ;
function Disconnect( variable useAutoErrorRecovery ) variable ;
function FilterPlatePlaced( variable useAutoErrorRecovery ) variable ;
function FilterPlateRemoved( variable useAutoErrorRecovery ) variable ;
function FilterPlateToWaste( variable useAutoErrorRecovery, variable f_height, variable n_height, variable contr_pnts ) variable ;
private function HandleError( variable errorTitle ) variable ;
function Initialize( variable useAutoErrorRecovery ) variable ;
function InitializeMPELibrary( variable blnSimMode ) void ;
function ManualMPEErrorRecovery(  ) void ;
function ProcessFilterToCollectionPlate( variable useAutoErrorRecovery, variable returnPlateToIntegrationArea ) variable ;
function ProcessFilterToWaste( variable useAutoErrorRecovery, variable returnPlateToIntegrationArea ) variable ;
function RetrieveFilterPlate( variable useAutoErrorRecovery ) variable ;
function SetCollectionPlateHeight( variable inputVar ) void ;
function SetCommPort( variable inputVar ) void ;
function SetControlPoints( variable inputVar ) void ;
function SetFilterHeight( variable inputVar ) void ;
function SetNozzleHeight( variable inputVar ) void ;
function SetOffsetFromNozzles( variable inputVar ) void ;
function SetVacuumCheck( variable inputVar ) void ;
function SetWasteContainerID( variable inputVar ) void ;
function UserSelectControlPoints(  ) void ;
// }} ""
function _InitLibrary() {
// {{ 2 "AutoInitBlock" ""
// }} ""
}
function _ExitLibrary() {
// {{ 2 "AutoExitBlock" ""
// }} ""
}
// {{{ 5 "ManualMPEErrorRecovery" "Begin"
function ManualMPEErrorRecovery(  ) void {
// }} ""
private variable loopCounter1;
private dialog customDialog0736004E3B174efe82BC5C8DDFCF66B2;
private variable isFinished;
private variable userChoice;
private variable errorMessage;
private dialog dialogHandleFAD64B3EB4224c98B343A6905AEC112E;
private variable returnPlate;
private dialog dialogHandle35B302512C6444e3ADA3CDC360B33F3A;
private dialog dialogHandle3;
private variable blnMPEReturn;
private dialog dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD;
private dialog dialogHandle008EF7D86C3E46709AF685305EA78614;
private dialog dialogHandle3B3238F600F3486f9DF125CD1F939477;
// {{ 5 "ManualMPEErrorRecovery" "InitLocals"
// }} ""
// {{ 199 1 0 "5790874a_90b0_4c2c_b2cd257e9a69e71b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
userChoice = 0;
// }} ""
// {{ 200 1 0 "019b3bba_855a_4fee_8cd15930152dc390" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (isFinished != 1)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 201 1 0 "5567b069_1878_438f_a32176e19daeb0e8" "{998A7CCC-4374-484D-A6ED-E8A4F0EB71BA}"
customDialog0736004E3B174efe82BC5C8DDFCF66B2.InitCustomDialog( "5567b069_1878_438f_a32176e19daeb0e8" );
customDialog0736004E3B174efe82BC5C8DDFCF66B2.ShowCustomDialog();
userChoice = customDialog0736004E3B174efe82BC5C8DDFCF66B2.GetCustomDialogProperty( "ReturnValue" );
// }} ""
// {{ 202 1 0 "f3309316_25cf_4bec_8d3bce2b7767f2c0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 203 1 0 "9d5b4be2_9ee2_49dd_a9f0f2df0828503b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 1)
{
// }} ""
// {{ 204 1 0 "642018eb_a441_4097_a87415ec37feeb98" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 205 1 0 "93edad28_5114_42cf_9b6bb5b77b619cf6" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 0;
// }} ""
// {{ 206 1 0 "d8753e0a_02a4_4e99_952f6b7d8c7cf0e8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
isFinished = 1;
// }} ""
// {{ 207 1 0 "9d5b4be2_9ee2_49dd_a9f0f2df0828503b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 208 1 0 "d9a68025_26d4_4d81_9e93b4ec9739fd70" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 10)
{
// }} ""
// {{ 209 1 0 "09d510df_97da_4c3e_9689e8a88963dbe0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 210 1 0 "4616a176_1f59_4239_a6e778e6ee1e7164" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InitializeMPELibrary(_blnSimulationMode);
// }} ""
// {{ 211 1 0 "f56a20c4_709f_419f_9fde1319c2e6c293" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 0;
// }} ""
// {{ 212 1 0 "d9a68025_26d4_4d81_9e93b4ec9739fd70" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 213 1 0 "44298dff_dc71_4ae4_99429d1348fd104a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 11)
{
// }} ""
// {{ 214 1 0 "d4f5d479_37d8_4956_99969ac2a50033cc" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 215 1 0 "89cb2c31_524c_4449_b5d7cb44683e8080" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ConnectUsingCOM(comPort, baudRate, _blnSimulationMode, MPE2DevID, 0);
// }} ""
// {{ 216 1 0 "44298dff_dc71_4ae4_99429d1348fd104a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 217 1 0 "28cce146_bf6a_4408_b52b71821b69d0d2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 12)
{
// }} ""
// {{ 218 1 0 "5eef5714_1c8b_422e_919a855c1ebe5125" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 219 1 0 "18c7ecde_2eea_44b9_81564b6c38186233" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::Disconnect(MPE2DevID);
// }} ""
// {{ 220 1 0 "28cce146_bf6a_4408_b52b71821b69d0d2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 221 1 0 "7c73a09d_9f96_4b4f_80f6b68ee3da4d0b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 13)
{
// }} ""
// {{ 222 1 0 "af9340f8_acb0_4ff2_aaa05e772b35148f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 223 1 0 "b0de0caf_dd50_4f2a_a182046e8e8bdde3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::Initialize(MPE2DevID);
// }} ""
// {{ 224 1 0 "7c73a09d_9f96_4b4f_80f6b68ee3da4d0b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 225 1 0 "974385b6_24f2_4b4b_812076da2d4f5d98" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 14)
{
// }} ""
// {{ 226 1 0 "555b9450_eac7_4b36_b758d77455c6fe7c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 227 1 0 "2d980fde_cc47_4198_acf947d6ab705099" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle3.SetInputSize(1);
dialogHandle3.SetInputField(0, Translate("blnMPEVacuumCheck: "), hslInteger, blnMPEVacuumCheck, 0, 1);
dialogHandle3.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
blnMPEVacuumCheck = dialogHandle3.GetInputField(0);
// }} ""
// {{ 228 1 0 "974385b6_24f2_4b4b_812076da2d4f5d98" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 229 1 0 "55c2be92_725a_4cbd_8622cdbca9850252" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 15)
{
// }} ""
// {{ 230 1 0 "a3f3d039_2407_40bc_a07f11a30bca6f98" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 231 1 0 "b9748859_0d08_4e56_b1a54d397f929184" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.SetInputSize(2);
dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.SetInputField(0, Translate("nozzleHeight: "), hslFloat, nozzleHeight, 0, 1000);
dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.SetInputField(1, Translate("filterHeight: "), hslFloat, filterHeight, 0, 1000);
dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
nozzleHeight = dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.GetInputField(0);
filterHeight = dialogHandle5CEE08DCC2014668BAE0E92EC2D940FD.GetInputField(1);
// }} ""
// {{{ 232 1 0 "7d190a6d_d25c_452c_bc0dd1b1ea8d6606" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::FilterPlatePlaced(MPE2DevID, filterHeight, nozzleHeight);
// }} ""
// {{ 233 1 0 "55c2be92_725a_4cbd_8622cdbca9850252" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 234 1 0 "43a4ce90_a4aa_4ddf_ad1352b34166aa0a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 16)
{
// }} ""
// {{ 235 1 0 "5a4f4f4d_4d6d_4165_9c0ecc6492afd5cd" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 236 1 0 "41a5e5ec_b4ae_485c_89c6ac834dd22731" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
UserSelectControlPoints();
// }} ""
// {{ 237 1 0 "499e04af_8c2d_4764_8378cfd1801887d5" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle008EF7D86C3E46709AF685305EA78614.SetInputSize(1);
dialogHandle008EF7D86C3E46709AF685305EA78614.SetInputField(0, Translate("return plate?"), hslInteger, 1, 0, 1);
dialogHandle008EF7D86C3E46709AF685305EA78614.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
returnPlate = dialogHandle008EF7D86C3E46709AF685305EA78614.GetInputField(0);
// }} ""
// {{{ 238 1 0 "9171e411_96d8_4c44_aaa552b498dfb086" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ProcessFilterToWasteContainer(MPE2DevID, controlPoints, returnPlate, wasteContainerID, blnMPEVacuumCheck);
// }} ""
// {{ 239 1 0 "43a4ce90_a4aa_4ddf_ad1352b34166aa0a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 240 1 0 "0691305e_c362_450d_8bbc48f48cc6d403" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 17)
{
// }} ""
// {{ 241 1 0 "061809bd_b06c_4441_82489e00e75b3ea7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 242 1 0 "aa346c26_82ef_4139_b26d244825a63011" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ClampFilterPlate(MPE2DevID);
// }} ""
// {{ 243 1 0 "0691305e_c362_450d_8bbc48f48cc6d403" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 244 1 0 "ac24002a_5e02_48b7_90f41d777da6d9e3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 18)
{
// }} ""
// {{ 245 1 0 "956cb5c2_f281_4328_91b33228ea07dd5e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 246 1 0 "73500905_2b83_41e3_9ce671832901438a" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle3B3238F600F3486f9DF125CD1F939477.SetInputSize(2);
dialogHandle3B3238F600F3486f9DF125CD1F939477.SetInputField(0, Translate("collectionPlateHeight: "), hslFloat, collectionPlateHeight, 0, 1000);
dialogHandle3B3238F600F3486f9DF125CD1F939477.SetInputField(1, Translate("offsetFromNozzles: "), hslFloat, offsetFromNozzles, 0, 1000);
dialogHandle3B3238F600F3486f9DF125CD1F939477.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
collectionPlateHeight = dialogHandle3B3238F600F3486f9DF125CD1F939477.GetInputField(0);
offsetFromNozzles = dialogHandle3B3238F600F3486f9DF125CD1F939477.GetInputField(1);
// }} ""
// {{{ 247 1 0 "f4462619_e5e0_4e6b_b8a085c23fd19804" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::CollectionPlatePlaced(MPE2DevID, collectionPlateHeight, offsetFromNozzles);
// }} ""
// {{ 248 1 0 "ac24002a_5e02_48b7_90f41d777da6d9e3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 249 1 0 "41af688e_d904_4647_8126785eac46ebd2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 19)
{
// }} ""
// {{ 250 1 0 "3b775095_2d9e_4ba4_a6efeb7f07743c46" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 251 1 0 "06a47e57_6754_410c_95707205f3921728" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
UserSelectControlPoints();
// }} ""
// {{ 252 1 0 "6015c425_7a7d_4aeb_a0f79fc66cf3c48a" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle35B302512C6444e3ADA3CDC360B33F3A.SetInputSize(1);
dialogHandle35B302512C6444e3ADA3CDC360B33F3A.SetInputField(0, Translate("return plate?"), hslInteger, 1, 0, 1);
dialogHandle35B302512C6444e3ADA3CDC360B33F3A.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
returnPlate = dialogHandle35B302512C6444e3ADA3CDC360B33F3A.GetInputField(0);
// }} ""
// {{{ 253 1 0 "05b88a7f_816e_461f_b57dc96f5df84292" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ProcessFilterToCollectionPlate(MPE2DevID, controlPoints, returnPlate);
// }} ""
// {{ 254 1 0 "41af688e_d904_4647_8126785eac46ebd2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 255 1 0 "de30bf97_45bb_4f9d_9e0f93b5e1869426" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 20)
{
// }} ""
// {{ 256 1 0 "c1f9dc77_a60f_4cd5_b79af0774f314f10" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 257 1 0 "76a3f9a7_4e04_424f_897dda40f07c5154" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::RetrieveFilterPlate(MPE2DevID);
// }} ""
// {{ 258 1 0 "de30bf97_45bb_4f9d_9e0f93b5e1869426" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 259 1 0 "be5fd16d_7d74_4382_bea07831a2ac2d81" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 21)
{
// }} ""
// {{ 260 1 0 "03275858_307a_4568_82c37f90900d5bda" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 261 1 0 "09beb760_a958_4031_b4a50b640b46a1d8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::FilterPlateRemoved(MPE2DevID);
// }} ""
// {{ 262 1 0 "be5fd16d_7d74_4382_bea07831a2ac2d81" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 263 1 0 "1a277f10_c312_4d1a_8e2182f9876a91c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 22)
{
// }} ""
// {{ 264 1 0 "554f2e1c_4d7a_468f_922233799f374df7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 265 1 0 "bad5230e_8b2f_4a9f_8a8d998a57a7373e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::CollectionPlateRemoved(MPE2DevID);
// }} ""
// {{ 266 1 0 "1a277f10_c312_4d1a_8e2182f9876a91c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 267 1 0 "02b7c83c_d468_4ec6_838941cb27b0c3d4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 268 1 0 "1b410c48_604d_4be4_b85c2f1395856e32" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 269 1 0 "d5304a70_c6df_4155_92136d08c4462693" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{{ 270 1 0 "fbc5d35c_0496_4705_aa4ee896ed221134" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMPELib::GetLastError(MPE2DevID, 1, errorMessage);
// }} ""
// {{ 271 1 0 "15176edd_e415_4834_ba322d6b6b43c468" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleFAD64B3EB4224c98B343A6905AEC112E.SetOutput(errorMessage);
dialogHandleFAD64B3EB4224c98B343A6905AEC112E.ShowOutput(Translate("MPE Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 272 1 0 "d5304a70_c6df_4155_92136d08c4462693" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 273 1 0 "019b3bba_855a_4fee_8cd15930152dc390" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "ManualMPEErrorRecovery" "End"
}
// }} ""
// {{{ 5 "InitializeMPELibrary" "Begin"
function InitializeMPELibrary( variable blnSimMode ) void {
// }} ""
// {{ 5 "InitializeMPELibrary" "InitLocals"
// }} ""
// {{ 192 1 0 "acb122d0_218f_4673_8cc20393e0803c69" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
comPort = 14;
// }} ""
// {{ 193 1 0 "1ac8c894_89d1_4992_8ce59ce23940920a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
baudRate = 921600;
// }} ""
// {{ 194 1 0 "e8624bc1_13aa_4a04_938b489be76f7bd1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEVacuumCheck = 1;
// }} ""
// {{ 195 1 0 "61f74b88_6b0f_4961_965dd5687f959d7f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
controlPoints = "-";
// }} ""
// {{ 196 1 0 "6b31ea50_32c1_4dc6_b05fe5212349bae5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
wasteContainerID = 0;
// }} ""
// {{ 197 1 0 "2df15206_3ac4_469f_96c57a4f5b62deb0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
_blnSimulationMode = blnSimMode;
// }} ""
// {{{ 5 "InitializeMPELibrary" "End"
}
// }} ""
// {{{ 5 "Connect" "Begin"
function Connect( variable useAutoErrorRecovery ) variable {
// }} ""
private variable blnMPEReturn;
private variable loopCounter2;
private variable userChoice;
private variable errorTitle;
private variable testVars;
private dialog dialogHandle978A1CBBBECC4ba79485835A2D8082F4;
// {{ 5 "Connect" "InitLocals"
// }} ""
// {{ 64 1 0 "afd01a3a_72ef_4b77_bb7aad410af1c716" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 65 1 0 "ade4577a_dcfc_407b_b27607fde35cc401" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
testVars = comPort * baudRate;
// }} ""
// {{ 66 1 0 "3daa6cee_c6fc_47e8_aa2c864054956558" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (testVars == 0)
{
// }} ""
// {{ 67 1 0 "a386ff2a_da75_4f38_8ffee97538df2088" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle978A1CBBBECC4ba79485835A2D8082F4.SetInputSize(2);
dialogHandle978A1CBBBECC4ba79485835A2D8082F4.SetInputField(0, Translate("comPort: "), hslInteger, comPort, 1, 1000);
dialogHandle978A1CBBBECC4ba79485835A2D8082F4.SetInputField(1, Translate("baudRate: "), hslInteger, baudRate, 1, 1000000);
dialogHandle978A1CBBBECC4ba79485835A2D8082F4.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
comPort = dialogHandle978A1CBBBECC4ba79485835A2D8082F4.GetInputField(0);
baudRate = dialogHandle978A1CBBBECC4ba79485835A2D8082F4.GetInputField(1);
// }} ""
// {{ 68 1 0 "3daa6cee_c6fc_47e8_aa2c864054956558" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 69 1 0 "1824375e_5a86_4d05_82afa6202d5feb9f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 70 1 0 "e1e22519_edaa_41f8_9c2c5df6bbcced6b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 71 1 0 "85d9cd23_bdd6_47fe_9fed9e03d1938169" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 72 1 0 "9d91104d_a833_446a_ae95a554b1c4c437" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 73 1 0 "bc26d6ca_95dd_481a_9393fa18d119862a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ConnectUsingCOM(comPort, baudRate, _blnSimulationMode, MPE2DevID, 0);
// }} ""
// {{ 74 1 0 "89394765_5a7e_4e52_8b861551756d2d97" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on Connect()");
// }} ""
// {{ 75 1 0 "2bd5708e_eb36_4a41_a8754ed8cf249977" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 76 1 0 "f05a318a_f412_4fd6_a8345ce6d677a8f5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 77 1 0 "a0a518b4_691a_4e95_ae76f9647ef728a2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 78 1 0 "82c67544_9aed_44a9_9b872adb7b5fa16c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 79 1 0 "a0a518b4_691a_4e95_ae76f9647ef728a2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 80 1 0 "6305140b_cc09_4b16_b2aa2ba5e1af8f6d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 81 1 0 "dd6fa938_4621_46ad_a56c7ef90199f24e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 82 1 0 "c2c00467_1f68_4fa1_b7c950c8a1b1c338" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 83 1 0 "dd6fa938_4621_46ad_a56c7ef90199f24e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 84 1 0 "a0a518b4_691a_4e95_ae76f9647ef728a2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 85 1 0 "f05a318a_f412_4fd6_a8345ce6d677a8f5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 86 1 0 "85d9cd23_bdd6_47fe_9fed9e03d1938169" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 87 1 0 "f00dbb7e_9641_4291_b7966ee0e6ca56fb" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "Connect" "End"
}
// }} ""
// {{{ 5 "FilterPlatePlaced" "Begin"
function FilterPlatePlaced( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
private variable testVars;
private dialog dialogHandle118086FD2AEB4e729227F2235E94DEFC;
// {{ 5 "FilterPlatePlaced" "InitLocals"
// }} ""
// {{ 108 1 0 "9458a132_3a56_4db7_a04587e9bf82ef76" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 109 1 0 "93ff6d01_811f_4fd3_b81e939114eef434" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
testVars = nozzleHeight * filterHeight;
// }} ""
// {{ 110 1 0 "1349f44a_0bc7_4218_a996bd322b0d7924" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (testVars == 0)
{
// }} ""
// {{ 111 1 0 "1c6f28be_f542_4d3d_a5110cfbb83e1b75" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle118086FD2AEB4e729227F2235E94DEFC.SetInputSize(2);
dialogHandle118086FD2AEB4e729227F2235E94DEFC.SetInputField(0, Translate("nozzleHeight: "), hslFloat, nozzleHeight, 0, 1000);
dialogHandle118086FD2AEB4e729227F2235E94DEFC.SetInputField(1, Translate("filterHeight: "), hslFloat, filterHeight, 0, 1000);
dialogHandle118086FD2AEB4e729227F2235E94DEFC.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
nozzleHeight = dialogHandle118086FD2AEB4e729227F2235E94DEFC.GetInputField(0);
filterHeight = dialogHandle118086FD2AEB4e729227F2235E94DEFC.GetInputField(1);
// }} ""
// {{ 112 1 0 "1349f44a_0bc7_4218_a996bd322b0d7924" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 113 1 0 "05c33b29_59a0_47e3_9bdcafb3a5aadbd1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 114 1 0 "061e94f1_19cf_408a_bc39569b6c60eb6b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 115 1 0 "464c2cda_56cd_42bc_819582d2492fd9fa" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 116 1 0 "4ebedde7_eeb0_4b85_ad88116ab69dd462" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 117 1 0 "bff99278_4de9_449e_a8a56b3dc0366e49" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::FilterPlatePlaced(MPE2DevID, filterHeight, nozzleHeight);
// }} ""
// {{ 118 1 0 "0b5e31e3_33b7_4634_ac125afcb32002eb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on FilterPlatePlaced()");
// }} ""
// {{ 119 1 0 "b6eabfd1_5837_44f1_a0fed8b3d5f6df9c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 120 1 0 "7be25dd0_ed27_418b_8550374db0fe6072" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 121 1 0 "6c2a75e4_1a6e_487a_a5409c407c336ab0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 122 1 0 "c61b683c_e2f9_47d1_b76ee04bb4653e04" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 123 1 0 "6c2a75e4_1a6e_487a_a5409c407c336ab0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 124 1 0 "68fa0f4d_84ca_456b_ad1bbc185d0e452a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 125 1 0 "b701eb9e_1750_4610_b2fa5575c2c2292c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 126 1 0 "a7a38201_3f5a_43e3_b900f7eea0a1b2ed" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 127 1 0 "b701eb9e_1750_4610_b2fa5575c2c2292c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 128 1 0 "6c2a75e4_1a6e_487a_a5409c407c336ab0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 129 1 0 "7be25dd0_ed27_418b_8550374db0fe6072" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 130 1 0 "464c2cda_56cd_42bc_819582d2492fd9fa" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 131 1 0 "374cbbe2_12f4_45ac_bc6a4cada8332aef" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "FilterPlatePlaced" "End"
}
// }} ""
// {{{ 5 "HandleError" "Begin"
private function HandleError( variable errorTitle ) variable {
// }} ""
private variable errorMessage;
private variable userChoice;
private variable loopCounter1;
private dialog customDialog78BF8481292C488b8ED1F644ED358429;
// {{ 5 "HandleError" "InitLocals"
// }} ""
// {{{ 161 1 0 "e37b61f9_b49b_4f4d_bda76a2b3f4bf963" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMPELib::GetLastError(MPE2DevID, 0, errorMessage);
// }} ""
// {{{ 162 1 0 "2f1f7677_e968_4c37_97e888eb74f01645" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcFormatTrace(Translate("MPE2"), Translate("Error Handling"), 3, errorTitle, errorMessage);
// }} ""
// {{ 163 1 0 "bd9c3473_ea88_4e25_a28be4ed175e4179" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
userChoice = 7;
// }} ""
// {{ 164 1 0 "a1585332_96eb_46cc_956910cc4180593e" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (userChoice == 7)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 165 1 0 "5953dd3a_07bd_4abb_8531e9b5bbe3a22a" "{998A7CCC-4374-484D-A6ED-E8A4F0EB71BA}"
customDialog78BF8481292C488b8ED1F644ED358429.InitCustomDialog( "5953dd3a_07bd_4abb_8531e9b5bbe3a22a" );
customDialog78BF8481292C488b8ED1F644ED358429.SetCustomDialogProperty( "Title", errorTitle );
customDialog78BF8481292C488b8ED1F644ED358429.SetCustomDialogProperty( "textBlock.Text", errorMessage );
customDialog78BF8481292C488b8ED1F644ED358429.ShowCustomDialog();
userChoice = customDialog78BF8481292C488b8ED1F644ED358429.GetCustomDialogProperty( "ReturnValue" );
// }} ""
// {{ 166 1 0 "f43f4a5d_771f_4fa7_b2bafaee24335319" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 7)
{
// }} ""
// {{{ 167 1 0 "76532c1a_97e7_4a1c_990a2ecff0afb34b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ManualMPEErrorRecovery();
// }} ""
// {{ 168 1 0 "f43f4a5d_771f_4fa7_b2bafaee24335319" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 169 1 0 "a1585332_96eb_46cc_956910cc4180593e" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 170 1 0 "85915d05_b31b_4307_90d2424acf282ca9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMPELib::GetLastError(MPE2DevID, 1, errorMessage);
// }} ""
// {{{ 171 1 0 "03482234_3b62_4e37_a16dfec5852120f8" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (userChoice);
// }} ""
// {{{ 5 "HandleError" "End"
}
// }} ""
// {{{ 5 "Disconnect" "Begin"
function Disconnect( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "Disconnect" "InitLocals"
// }} ""
// {{ 89 1 0 "0a3e99f4_536f_48a5_8cc0049ce48df867" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 90 1 0 "4dfa7924_7fc6_4317_96a428ca900c896b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 91 1 0 "264cc4ba_35c8_4d7f_b3513d34b5992c6d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 92 1 0 "f6af64fb_e77b_4e57_b3e90a4d7c1273d6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::Disconnect(MPE2DevID);
// }} ""
// {{ 93 1 0 "aa8c98f9_dc45_4d74_94d04df76669fb34" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on Disconnect()");
// }} ""
// {{ 94 1 0 "4e940c78_17fb_4ddc_bdb04ef122840364" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 95 1 0 "2be6f209_b395_4c40_b0f58f632c4e0ae2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 96 1 0 "48a11444_e7fc_44dd_8a344e7af1455272" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 97 1 0 "4e829d52_7f4a_45a5_86f3ea3b09b46694" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 98 1 0 "48a11444_e7fc_44dd_8a344e7af1455272" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 99 1 0 "a95b4c5a_3e25_470b_8df0180c9beebe70" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 100 1 0 "cd657522_6fd2_497e_95026cf15c484265" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 101 1 0 "ef60c502_f279_4ea5_8f324d673edec8fc" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 102 1 0 "cd657522_6fd2_497e_95026cf15c484265" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 103 1 0 "48a11444_e7fc_44dd_8a344e7af1455272" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 104 1 0 "2be6f209_b395_4c40_b0f58f632c4e0ae2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 105 1 0 "4dfa7924_7fc6_4317_96a428ca900c896b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 106 1 0 "71bfc10f_a11a_43d9_a288e336e0f1c87a" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "Disconnect" "End"
}
// }} ""
// {{{ 5 "Initialize" "Begin"
function Initialize( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "Initialize" "InitLocals"
// }} ""
// {{ 173 1 0 "e6f5e93f_2d40_461a_829273d2793438a3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 174 1 0 "9f94ab4c_d985_4b9e_8f73a63819ce745b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 175 1 0 "ef4e74ec_5995_4ef6_9eb261a66af839ee" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 176 1 0 "7bc2aa1c_97c4_4d77_a197833f7a21ef1b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::Initialize(MPE2DevID);
// }} ""
// {{ 177 1 0 "c4879d7c_f113_4e58_91b76d7b4985adbc" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on Initialize()");
// }} ""
// {{ 178 1 0 "1592055d_8384_4cdd_814c43ca5f316c3f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 179 1 0 "4bfc3228_c9ae_43cc_b0b96b4ba080f437" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 180 1 0 "af29b05c_1723_4675_8b712bfd362a32bf" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 181 1 0 "b09d66e6_bf22_469b_846c77c4f7ade995" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 182 1 0 "af29b05c_1723_4675_8b712bfd362a32bf" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 183 1 0 "7188b410_e2dd_44ba_a1864ee8c0fd7e04" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 184 1 0 "b44e92be_9322_453f_8f0c22cfbfd1a879" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 185 1 0 "2bef5b09_f303_4323_966369fc9982c89b" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 186 1 0 "b44e92be_9322_453f_8f0c22cfbfd1a879" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 187 1 0 "af29b05c_1723_4675_8b712bfd362a32bf" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 188 1 0 "4bfc3228_c9ae_43cc_b0b96b4ba080f437" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 189 1 0 "9f94ab4c_d985_4b9e_8f73a63819ce745b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 190 1 0 "5235949a_0e52_4207_a8e7621eb5d29a66" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "Initialize" "End"
}
// }} ""
// {{{ 5 "CollectionPlatePlaced" "Begin"
function CollectionPlatePlaced( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
private variable testVars;
private dialog dialogHandle0F41CE143D474d19B775D90854086ABE;
// {{ 5 "CollectionPlatePlaced" "InitLocals"
// }} ""
// {{ 20 1 0 "fd21bb43_60c0_40d4_919269398306246d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("*** MPE_Library.CollectionPlatePlaced ***"));
// }} ""
// {{ 21 1 0 "dbaab271_3e6f_45ed_8641c9e97cb10899" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
testVars = collectionPlateHeight * 1;
// }} ""
// {{ 22 1 0 "c6027d5f_9a7f_4044_9f6d5672dfbb92ff" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (testVars == 0)
{
// }} ""
// {{ 23 1 0 "f697a87a_3a7d_4746_83ff5b1662a6ac8d" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle0F41CE143D474d19B775D90854086ABE.SetInputSize(2);
dialogHandle0F41CE143D474d19B775D90854086ABE.SetInputField(0, Translate("collectionPlateHeight: "), hslFloat, collectionPlateHeight, 0, 1000);
dialogHandle0F41CE143D474d19B775D90854086ABE.SetInputField(1, Translate("offsetFromNozzles: "), hslFloat, offsetFromNozzles, 0, 1000);
dialogHandle0F41CE143D474d19B775D90854086ABE.ShowInput("", hslInfinite, hslOKOnly | hslDefButton1);
collectionPlateHeight = dialogHandle0F41CE143D474d19B775D90854086ABE.GetInputField(0);
offsetFromNozzles = dialogHandle0F41CE143D474d19B775D90854086ABE.GetInputField(1);
// }} ""
// {{ 24 1 0 "c6027d5f_9a7f_4044_9f6d5672dfbb92ff" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 25 1 0 "23b53d85_ad97_49d1_aed5c5cea16ff92a" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 26 1 0 "69498beb_d4b9_46b2_ada0d2debc065af4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 27 1 0 "87874fc0_5f00_4d3a_b364b762c645ab02" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 28 1 0 "b436026b_9e5e_4737_a8487ed596a8a421" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 29 1 0 "f9eedbb7_7e5d_4848_bf2bcc1c8b8e8a86" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::CollectionPlatePlaced(MPE2DevID, collectionPlateHeight, offsetFromNozzles);
// }} ""
// {{ 30 1 0 "5ae71820_1bea_4ab9_a3afbe642c9f193b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on CollectionPlatePlaced()");
// }} ""
// {{ 31 1 0 "d830fa1a_a8f3_4473_80e09773dd722047" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 32 1 0 "e7d9628b_6889_4c67_b95261ffadb570dc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 33 1 0 "42c16e14_8f48_4445_9418d0b4f4465d25" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 34 1 0 "1b9866b3_51ee_4638_85c3a2ef4d0e361a" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 35 1 0 "42c16e14_8f48_4445_9418d0b4f4465d25" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 36 1 0 "effc4d1e_e6fe_440b_ba9449e954c77bbb" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 37 1 0 "a570ff03_a352_4f24_a4700684140eb797" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 38 1 0 "42776744_bd89_4e0c_aeb845382cd97cee" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 39 1 0 "a570ff03_a352_4f24_a4700684140eb797" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 40 1 0 "42c16e14_8f48_4445_9418d0b4f4465d25" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 41 1 0 "e7d9628b_6889_4c67_b95261ffadb570dc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 42 1 0 "87874fc0_5f00_4d3a_b364b762c645ab02" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 43 1 0 "8d505e19_42d7_45b9_99d31c1ec3711915" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "CollectionPlatePlaced" "End"
}
// }} ""
// {{{ 5 "SetNozzleHeight" "Begin"
function SetNozzleHeight( variable inputVar ) void {
// }} ""
// {{ 5 "SetNozzleHeight" "InitLocals"
// }} ""
// {{ 350 1 0 "f0d731f0_9698_4d80_a5c54d2d22dc92e7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nozzleHeight = inputVar;
// }} ""
// {{{ 5 "SetNozzleHeight" "End"
}
// }} ""
// {{{ 5 "SetFilterHeight" "Begin"
function SetFilterHeight( variable inputVar ) void {
// }} ""
// {{ 5 "SetFilterHeight" "InitLocals"
// }} ""
// {{ 348 1 0 "3c03e09b_e4e0_48ca_ad813a8c30e7cd49" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
filterHeight = inputVar;
// }} ""
// {{{ 5 "SetFilterHeight" "End"
}
// }} ""
// {{{ 5 "SetCollectionPlateHeight" "Begin"
function SetCollectionPlateHeight( variable inputVar ) void {
// }} ""
// {{ 5 "SetCollectionPlateHeight" "InitLocals"
// }} ""
// {{ 342 1 0 "9b14af06_ca05_4743_9c2af320681c8903" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
collectionPlateHeight = inputVar;
// }} ""
// {{{ 5 "SetCollectionPlateHeight" "End"
}
// }} ""
// {{{ 5 "SetOffsetFromNozzles" "Begin"
function SetOffsetFromNozzles( variable inputVar ) void {
// }} ""
// {{ 5 "SetOffsetFromNozzles" "InitLocals"
// }} ""
// {{ 352 1 0 "251000bd_9fcb_4966_bba239eb9ef2d1b8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
offsetFromNozzles = inputVar;
// }} ""
// {{{ 5 "SetOffsetFromNozzles" "End"
}
// }} ""
// {{{ 5 "CollectionPlateRemoved" "Begin"
function CollectionPlateRemoved( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "CollectionPlateRemoved" "InitLocals"
// }} ""
// {{ 45 1 0 "14bec564_3272_42e5_843238e983aa1105" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 46 1 0 "788536ad_a397_4c8e_a4576fd53e78420e" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 47 1 0 "a290f952_583d_4f4b_b71fc9d3138395fa" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 48 1 0 "e029f903_8de7_4682_b11c71a2454e932e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::CollectionPlateRemoved(MPE2DevID);
// }} ""
// {{ 49 1 0 "18651dca_ddb7_4675_9967c53e114a2072" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on CollectionPlateRemoved()");
// }} ""
// {{ 50 1 0 "9aee8123_9d23_4ef5_9382821eea522fc5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 51 1 0 "74af022d_c6c7_4992_b39abf7cac8772e9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 52 1 0 "442b9a49_c0ae_46e2_a981a5312b67e8df" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 53 1 0 "d28db6ea_58ab_4cea_a922551fecc12800" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 54 1 0 "442b9a49_c0ae_46e2_a981a5312b67e8df" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 55 1 0 "4e7a263e_595a_47bb_9950016936cea386" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 56 1 0 "dca0766d_e0c7_49dd_ab2a5c6aad64d1a6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 57 1 0 "45a128b1_92b3_4b1c_a2619fee82c605b9" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 58 1 0 "dca0766d_e0c7_49dd_ab2a5c6aad64d1a6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 59 1 0 "442b9a49_c0ae_46e2_a981a5312b67e8df" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 60 1 0 "74af022d_c6c7_4992_b39abf7cac8772e9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 61 1 0 "788536ad_a397_4c8e_a4576fd53e78420e" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 62 1 0 "d38b5ee5_9682_4dd9_80c1c29e96b4b44d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "CollectionPlateRemoved" "End"
}
// }} ""
// {{{ 5 "FilterPlateRemoved" "Begin"
function FilterPlateRemoved( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "FilterPlateRemoved" "InitLocals"
// }} ""
// {{ 133 1 0 "648c7511_87a8_4b61_94238573adb90cbf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 134 1 0 "92eee9fb_95d4_4ba2_bbd71fba9d1b4df6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 135 1 0 "6c71643f_dfb7_41b5_820b6a6f64ef94bb" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 136 1 0 "bed65d1c_9150_4181_8d4cbae4c798a5b2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::FilterPlateRemoved(MPE2DevID);
// }} ""
// {{ 137 1 0 "097c616c_d3a2_4d51_b4903f2611ff603d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on FilterPlateRemoved()");
// }} ""
// {{ 138 1 0 "a99f5c12_606a_4fec_bad3a30be18db350" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 139 1 0 "bc7b86c7_3ae5_4854_b76a2192c894db67" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 140 1 0 "a3d656db_17a5_4566_a9e287ea416c3554" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 141 1 0 "6f31f425_3bfc_4e85_a1d93052e1e9b036" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 142 1 0 "a3d656db_17a5_4566_a9e287ea416c3554" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 143 1 0 "3c71bacd_85af_4fcf_a6c1d2f98b3051b7" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 144 1 0 "d792b096_02d3_4505_9b3b24883e513745" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 145 1 0 "6bc84d8c_f00b_4532_9067d09b41fed4ce" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 146 1 0 "d792b096_02d3_4505_9b3b24883e513745" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 147 1 0 "a3d656db_17a5_4566_a9e287ea416c3554" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 148 1 0 "bc7b86c7_3ae5_4854_b76a2192c894db67" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 149 1 0 "92eee9fb_95d4_4ba2_bbd71fba9d1b4df6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 150 1 0 "1142369d_9268_4cf9_bf9903490855c257" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "FilterPlateRemoved" "End"
}
// }} ""
// {{{ 5 "SetCommPort" "Begin"
function SetCommPort( variable inputVar ) void {
// }} ""
// {{ 5 "SetCommPort" "InitLocals"
// }} ""
// {{ 344 1 0 "0c17aa35_e259_4e29_8b30629772ad3dc4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
comPort = inputVar;
// }} ""
// {{{ 5 "SetCommPort" "End"
}
// }} ""
// {{{ 5 "SetVacuumCheck" "Begin"
function SetVacuumCheck( variable inputVar ) void {
// }} ""
// {{ 5 "SetVacuumCheck" "InitLocals"
// }} ""
// {{ 354 1 0 "41ae9b80_0bb1_4849_b0655117b9904f24" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEVacuumCheck = inputVar;
// }} ""
// {{{ 5 "SetVacuumCheck" "End"
}
// }} ""
// {{{ 5 "RetrieveFilterPlate" "Begin"
function RetrieveFilterPlate( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "RetrieveFilterPlate" "InitLocals"
// }} ""
// {{ 323 1 0 "a130f1ac_8fae_4d1a_94c76f4b75b96302" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 324 1 0 "e2982bf7_cba6_465d_9fdce41b77cece4f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 325 1 0 "c70ca5c5_f78b_40f0_873e1a4db7b383db" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 326 1 0 "4e8d34df_46bb_4b69_bf9259f139b3ea32" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::RetrieveFilterPlate(MPE2DevID);
// }} ""
// {{ 327 1 0 "e1a57bfd_dc56_4083_b4532b1d95505b1d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on RetrieveFilterPlate()");
// }} ""
// {{ 328 1 0 "0f4bb8a4_96a1_457b_b84d7ef501144f0f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 329 1 0 "a66dc35c_1ef8_497f_870b9f681ce8b21e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 330 1 0 "bf0e22a8_2ea5_49f3_ad45b6d02eb11050" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 331 1 0 "4b115e72_be4f_4637_ab1ae2ae6561556f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 332 1 0 "bf0e22a8_2ea5_49f3_ad45b6d02eb11050" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 333 1 0 "f6eb5a42_56e9_4738_93805424310ed6b6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 334 1 0 "62c9153e_3d07_43b4_898e50a5e59f696a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 335 1 0 "9eb8d511_cdfc_451e_be26a1bfc9e9b00f" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 336 1 0 "62c9153e_3d07_43b4_898e50a5e59f696a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 337 1 0 "bf0e22a8_2ea5_49f3_ad45b6d02eb11050" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 338 1 0 "a66dc35c_1ef8_497f_870b9f681ce8b21e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 339 1 0 "e2982bf7_cba6_465d_9fdce41b77cece4f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 340 1 0 "70038c75_fc7c_4835_b45d9911ad17870c" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "RetrieveFilterPlate" "End"
}
// }} ""
// {{{ 5 "ProcessFilterToCollectionPlate" "Begin"
function ProcessFilterToCollectionPlate( variable useAutoErrorRecovery, variable returnPlateToIntegrationArea ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "ProcessFilterToCollectionPlate" "InitLocals"
// }} ""
// {{ 275 1 0 "3d65a0d2_56a0_4b49_9d46a2a1431ef191" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 276 1 0 "f6eca832_bdae_49e7_afae8b177f483175" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (controlPoints == "-")
{
// }} ""
// {{{ 277 1 0 "1a67d388_242c_439d_a45a873e08b83640" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
UserSelectControlPoints();
// }} ""
// {{ 278 1 0 "f6eca832_bdae_49e7_afae8b177f483175" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 279 1 0 "ccd4039b_2391_42f2_8f25fbf4d0a3fa1e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 280 1 0 "71c5cb68_d5fe_493c_bbb970d415921efc" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 281 1 0 "236056d2_848a_4866_aea8c1ed0cea3658" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 282 1 0 "06b10cf2_428e_42f0_8b594bbed8f9f2c4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 283 1 0 "a10e1533_2e3d_4870_bb4031e2d8e81c88" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ProcessFilterToCollectionPlate(MPE2DevID, controlPoints, returnPlateToIntegrationArea);
// }} ""
// {{ 284 1 0 "28bbd75a_c80b_4168_8e22d80056f91c6a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on ProcessFilterToColletionPlate()");
// }} ""
// {{ 285 1 0 "a82f175d_49e3_49bd_99f4f2e22ffad996" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 286 1 0 "c79944f4_41d0_4684_aa4979901fadb79a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 287 1 0 "b59a87e0_9072_4985_bc40f0d9c6ae1510" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 288 1 0 "c8ded76a_66aa_499d_927e8cd612ab3d77" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 289 1 0 "b59a87e0_9072_4985_bc40f0d9c6ae1510" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 290 1 0 "c5a9fbf1_faa8_4628_9cbef523efd78fc4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 291 1 0 "a10376ec_d008_4973_817256053be777d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 292 1 0 "15f9dc3f_0b43_4db0_9dc811fbc00d3a5a" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 293 1 0 "a10376ec_d008_4973_817256053be777d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 294 1 0 "b59a87e0_9072_4985_bc40f0d9c6ae1510" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 295 1 0 "c79944f4_41d0_4684_aa4979901fadb79a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 296 1 0 "236056d2_848a_4866_aea8c1ed0cea3658" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 297 1 0 "4a7ee0f7_c9e0_4161_a5aee94819f26e18" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "ProcessFilterToCollectionPlate" "End"
}
// }} ""
// {{{ 5 "UserSelectControlPoints" "Begin"
function UserSelectControlPoints(  ) void {
// }} ""
private dialog customDialogD342E2BFD0234086A1076639676E7A1F;
// {{ 5 "UserSelectControlPoints" "InitLocals"
// }} ""
// {{ 358 1 0 "d57f53dd_f89b_41c4_a6c438ed092352ae" "{998A7CCC-4374-484D-A6ED-E8A4F0EB71BA}"
customDialogD342E2BFD0234086A1076639676E7A1F.InitCustomDialog( "d57f53dd_f89b_41c4_a6c438ed092352ae" );
customDialogD342E2BFD0234086A1076639676E7A1F.SetCustomDialogProperty( "textBox1.Text", controlPoints );
customDialogD342E2BFD0234086A1076639676E7A1F.ShowCustomDialog();
controlPoints = customDialogD342E2BFD0234086A1076639676E7A1F.GetCustomDialogProperty( "textBox1.Text" );
// }} ""
// {{{ 5 "UserSelectControlPoints" "End"
}
// }} ""
// {{{ 5 "ProcessFilterToWaste" "Begin"
function ProcessFilterToWaste( variable useAutoErrorRecovery, variable returnPlateToIntegrationArea ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "ProcessFilterToWaste" "InitLocals"
// }} ""
// {{ 299 1 0 "f96b8d50_0991_4fe8_9060e45335039a2c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 300 1 0 "87744df2_6ef3_4ff0_a383c552dfe4439a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (controlPoints == "-")
{
// }} ""
// {{{ 301 1 0 "3a8f1537_1250_4e21_b564c90bcfdbd265" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
UserSelectControlPoints();
// }} ""
// {{ 302 1 0 "87744df2_6ef3_4ff0_a383c552dfe4439a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 303 1 0 "3c20644c_d421_4059_9301bf7a46bbc909" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 304 1 0 "38d60dfd_638f_497a_b4829f428188c54f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 305 1 0 "8d710332_8903_4e6d_90502b92e2cf32e1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 306 1 0 "176b3924_7a97_4b99_b482fc9e1af82c92" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 307 1 0 "406b6be8_de82_4d81_95aae40ebc17d15e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ProcessFilterToWasteContainer(MPE2DevID, controlPoints, returnPlateToIntegrationArea, wasteContainerID, blnMPEVacuumCheck);
// }} ""
// {{ 308 1 0 "c5c0f992_7c9b_49bc_b9bf13d01ea006c2" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on ProcessFilterToWasteContainer()");
// }} ""
// {{ 309 1 0 "716a8ae8_8e8d_4156_b2d413ca106e7b51" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 310 1 0 "ae9689e4_8764_41f6_9337b1d7b14e89fd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 311 1 0 "52a0bd27_c4dd_4156_a362b77cabdc4282" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 312 1 0 "179f5e59_5f77_4cce_99966e3b483400c0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 313 1 0 "52a0bd27_c4dd_4156_a362b77cabdc4282" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 314 1 0 "ce7a6804_9841_4f3f_a06a5945d2a49197" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 315 1 0 "8cc74538_9768_4378_a58a5ad001d2e985" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 316 1 0 "506fc734_97dd_43a1_a6dcea08913e7968" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 317 1 0 "8cc74538_9768_4378_a58a5ad001d2e985" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 318 1 0 "52a0bd27_c4dd_4156_a362b77cabdc4282" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 319 1 0 "ae9689e4_8764_41f6_9337b1d7b14e89fd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 320 1 0 "8d710332_8903_4e6d_90502b92e2cf32e1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 321 1 0 "35a32f84_9c6f_43f7_bc2d0777ac4a269e" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "ProcessFilterToWaste" "End"
}
// }} ""
// {{{ 5 "SetWasteContainerID" "Begin"
function SetWasteContainerID( variable inputVar ) void {
// }} ""
// {{ 5 "SetWasteContainerID" "InitLocals"
// }} ""
// {{ 356 1 0 "25935da2_936a_41b5_a8cf84d0f91668eb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
wasteContainerID = inputVar;
// }} ""
// {{{ 5 "SetWasteContainerID" "End"
}
// }} ""
// {{{ 5 "SetControlPoints" "Begin"
function SetControlPoints( variable inputVar ) void {
// }} ""
// {{ 5 "SetControlPoints" "InitLocals"
// }} ""
// {{ 346 1 0 "9a037a0c_a735_4552_836e0c6448caaec1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
controlPoints = inputVar;
// }} ""
// {{{ 5 "SetControlPoints" "End"
}
// }} ""
// {{{ 5 "ClampFilterPlate" "Begin"
function ClampFilterPlate( variable useAutoErrorRecovery ) variable {
// }} ""
private variable errorTitle;
private variable blnMPEReturn;
private variable userChoice;
private variable loopCounter2;
// {{ 5 "ClampFilterPlate" "InitLocals"
// }} ""
// {{ 1 1 0 "bffbb3d9_b3ef_490b_8cfa6f5622d6b6d1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{ 2 1 0 "52ef1e23_3a57_4193_942d7bed10181ac1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (blnMPEReturn != 0)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 3 1 0 "fdc3b983_b11e_4711_b4edf5f6de21be47" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 4 1 0 "a0bb7cb7_b899_4ac8_ae2062b983f8e123" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
blnMPEReturn = HSLMPELib::ClampFilterPlate(MPE2DevID);
// }} ""
// {{ 5 1 0 "be0ce305_167a_478c_8437184d1eb99460" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
errorTitle = Translate("Error on ClampFilterPlate()");
// }} ""
// {{ 6 1 0 "e6553c3b_3dd7_45f8_a46dd5f3cef87b4b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 7 1 0 "486aff9f_73b3_4a56_979d377b9eb2c3bb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (blnMPEReturn != 0)
{
// }} ""
// {{ 8 1 0 "ffd0258c_720e_4d28_9585a5510d45cb59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (useAutoErrorRecovery > 0)
{
// }} ""
// {{ 9 1 0 "cc2796a7_5592_47c5_bc7e272319c35019" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 10 1 0 "ffd0258c_720e_4d28_9585a5510d45cb59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 11 1 0 "b3c5d398_4b90_40bd_affc835d96f951c2" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
userChoice = HandleError(errorTitle);
// }} ""
// {{ 12 1 0 "2c7ad78e_fe5e_4645_a938ce23acbfc30f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (userChoice == 5)
{
// }} ""
// {{ 13 1 0 "8beca192_8c4c_4848_bc1f7e63e981e07b" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 14 1 0 "2c7ad78e_fe5e_4645_a938ce23acbfc30f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 15 1 0 "ffd0258c_720e_4d28_9585a5510d45cb59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 16 1 0 "486aff9f_73b3_4a56_979d377b9eb2c3bb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 17 1 0 "52ef1e23_3a57_4193_942d7bed10181ac1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 18 1 0 "99db7016_6aa3_4838_b2574118926ec67e" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "ClampFilterPlate" "End"
}
// }} ""
// {{{ 5 "FilterPlateToWaste" "Begin"
function FilterPlateToWaste( variable useAutoErrorRecovery, variable f_height, variable n_height, variable contr_pnts ) variable {
// }} ""
private variable blnMPEReturn;
// {{ 5 "FilterPlateToWaste" "InitLocals"
// }} ""
// {{ 152 1 0 "cc96f039_95e1_43b2_9cb99065e6e1af84" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
blnMPEReturn = 1;
// }} ""
// {{{ 153 1 0 "200ea6b2_d0f6_498f_b4876eae6e698cb7" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SetFilterHeight(f_height);
// }} ""
// {{{ 154 1 0 "d174c4d7_3d3b_48bd_ab0f42f0bb737cf0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SetNozzleHeight(n_height);
// }} ""
// {{{ 155 1 0 "d06f6d5e_e8a3_44e7_99c742c43582338b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
blnMPEReturn = FilterPlatePlaced(useAutoErrorRecovery);
// }} ""
// {{{ 156 1 0 "53ba2bd0_7ead_4e3d_bca0d56e86291625" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SetControlPoints(contr_pnts);
// }} ""
// {{{ 157 1 0 "6a89fc58_b3fc_40ad_a67140e5d419b670" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
blnMPEReturn = ProcessFilterToWaste(useAutoErrorRecovery, 1);
// }} ""
// {{{ 158 1 0 "7714b501_930b_49e0_892bf6c6d1dc0918" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
blnMPEReturn = FilterPlateRemoved(useAutoErrorRecovery);
// }} ""
// {{{ 159 1 0 "42f26f05_0021_4410_951473e3f67b0acb" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (blnMPEReturn);
// }} ""
// {{{ 5 "FilterPlateToWaste" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// {{{ 2 "LibraryNamespace" "End"
} // library namespace
// }} ""
// $$author=Hamilton$$valid=0$$time=2024-10-29 11:55$$checksum=94590004$$length=087$$