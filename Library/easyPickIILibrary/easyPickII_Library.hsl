//----------------------------------------------------------------
// Copyright (C) by HAMILTON Bonaduz AG, CH-7402 Bonaduz.
// All rights reserved.
//
// Project              : EasyPickII
// Module               : easyPickII_Library.hsl
// Description          : Wrapper functions for the EasyPickII COM API
//
//----------------------------------------------------------------

#ifndef __EASYPICKII_LIBRARY_hsl__
#define __EASYPICKII_LIBRARY_hsl__ 1

#include "HSLUtilLib.hsl"
#include "HSLMthLib.hsl"
#include "HSLStrLib.hsl"
#include "HSLDevLib.hsl"
#include "HSLSeqLib.hsl"

#include "easyPickII_Helper.hsl"

namespace EASYPICKII
{
   // Library Version
   static const variable LibraryVersion("1.1.0");

   //
   // public definitions
   //

   // Trace level enumerators
   const variable _TRACE_LEVEL_NONE   (0); // switch off trace
   const variable _TRACE_LEVEL_NORMAL (1); // trace errors
   const variable _TRACE_LEVEL_FULL   (2); // trace function entry/exit with parameters

   const variable _DATABASE_RETURN_VALUE_NO_ID_FOUND(-1);  // database functions return this value as record ID if record was not found.

   const variable _HSLTRUE(hslTrue);                       // definition for boolena true (hslTrue)
   const variable _HSLFALSE(hslFalse);                     // definition for boolean false (hslFalse)

   const variable _SIMULATION_MODE_OFF(hslFalse);          // Methode laeuft normal
   const variable _SIMULATION_MODE_ON(hslTrue);            // Methode laeuft im Simulationsmodus
   global variable _EASYPICKII_SimulationMode;             // Variable fuer den Simulationsmodus


   // Error code definitions. The return value of a function is an error code.
   namespace ERROR
   {
      const variable _NONE                           (0);   // No error
      namespace GENERAL
      {
         const variable _LIBRARY                      (1);   // HSL-Library error
         const variable _MLSTAR                       (2);   // MLStar-Library error
         const variable _APPLICATION                  (3);   // Application error
      } // namespace GENERAL
      namespace HALCON
      {
         const variable LICENSE_NOT_FOUND             (43);
      }
      namespace DATABASE
      {
         const variable _READ                         (97);  // Database read error
         const variable _WRITE                        (98);  // Database write error
         const variable _UPDATE                       (99);  // Database update error
         const variable RACKID_NOT_FOUND              (121);
      } // namespace DATABASE
      namespace COLONYANALYSER
      {
         const variable ANALYSER_ABORTED              (100);
         const variable ANALYSER_BUSY                 (101);
         const variable NO_PICTURE                    (102);
         const variable INVALID_COLOR_IMAGE           (103);
      }
      namespace IMAGESTITCHER
      {
      }

   } // namespace ERROR

   // Function Parameters Const
   namespace GUI
   {
      namespace SHOW
      {
         namespace MODE
         {
            const variable _NORMAL                     (1);   // Show Normal
            const variable _MAXIMIZED                  (2);   // Show Maximized
         } // namespace MODE
      } // namespace SHOW
      namespace LIVEVIEW
      {
         namespace MODE
         {
            const variable _NORMAL                     (1);   // Show Normal
         } // namespace MODE
         namespace DRAW
         {
            namespace COLOR
            {
               const variable _RED                     ("red");
               const variable _GREEN                   ("green");
               const variable _BLUE                    ("blue");
               const variable _ORANGE                  ("orange");
               const variable _CYAN                    ("cyan");
               const variable _MANGENTA                ("mangenta");
               const variable _YELLOW                  ("yellow");
               const variable _GRAY                    ("gray");
               const variable _BLACK                   ("black");
               const variable _WHITE                   ("white");
            } // namespace COLOR
            namespace DRAWMODE
            {
               const variable _FILL                    ("fill");
               const variable _MARGIN                  ("margin");
            } // namespace DRAWMODE
            namespace FONT
            {
               const variable _ARIAL                   ("Arial");
            } // namespace FONT
         } // namespace DRAW
      } // namespace LIVEVIEW
   } // namespace GUI

   namespace CAMERA
   {
      namespace SAVEPICTURE
      {
         namespace PICTUREFORMAT
         {
            const variable _TIFF                       ("tiff");
            const variable _BMP                        ("bmp");
            const variable _JPEG_UNCOPRESSED           ("jpeg");
            const variable _JPEG_80_PERCENT            ("jpeg 80");
            const variable _JPEG_60_PERCENT            ("jpeg 60");
            const variable _JPEG_40_PERCENT            ("jpeg 40");
            const variable _JPEG_20_PERCENT            ("jpeg 20");
            const variable _PNG                        ("png");
            const variable _PNG_COMPRESSED_BEST        ("png best");
            const variable _PNG_COMPRESSED_FASTEST     ("png fastest");
            const variable _PNG_NONE                   ("png none");
         } // namespace PICTUREFORMAT
      } // namespace SAVEPICTURE
   } // namespace CAMERA

   namespace EASYPICKII_HELPER
   {
      namespace LIGHTSOURCE
      {
         const variable _NO_LIGHT                     (0);   // None
         const variable _MLSTAR_DIV2_PWM1             (1);   // DIV2
         const variable _MLSTAR_DIV2_PWM2             (2);   // DIV2
         const variable _MLSTAR_DIV3_PWM3             (3);   // DIV3
         const variable _MLSTAR_DIV3_PWM4             (4);   // DIV3
         const variable _CAMERA_CANNEL                (5);   // Camera Channel
      } // namespace LIGHTSOURCE
   } // namespace EASYPICKII_HELPER

   namespace DATABASE
   {
      // SetEasyPickIIColonyPickingState()
      namespace PICKINGSTATE
      {
         const variable _NONE                       (0);
         const variable _OK                         (1);
         const variable _ERROR                      (2);
      }

      // sort mode for function RetrieveColonyPositions2
      namespace COLONYPOSITIONS_SORTMODE
      {
         // Retrive colonies sorted for minimal channel moves in Y direction (prio 1)
         // and in X direction (prio 2) over the number of requested colonies with highest weight.
         const variable SORT_OPTIMIZE_CHANNELS_MOVE (0);
         // Retrieve colonies with highest weight first.
         const variable SORT_WEIGHT_DESC            (1);
      }

   }



   //
   // internal definitions
   //

   // FormatTrace status enumerator
   namespace FmtStatus
   {
      static const variable Start      (1);
      static const variable Complete   (2);
      static const variable Error      (3);
   }

   // default values for FormatTrace
   static const variable FMT_SRC( "EasyPickII_Library"); // source of FormatTrace
   static const variable FMT_ACTION( "Trace"); // default action
   static const variable FMT_STATUS   (FmtStatus::Complete); // default status: complete

   static const variable EasyPickIIProgID("EASYPICKII.COM_Class");

   static global object   _EASYPICKII_COM_Application_Connection;                             // COM-Verbindung zur Application
   static global variable _EASYPICKII_COM_Application_Connection_UsedFlag(hslFalse);          // COM-Verbindung zur Application Flag

   static const variable _COM_INITIALISATION_DELAY(2);                      // Wartezeit der Initialisierung des easyPick COM-Interface

   // Function returns a formatted error message for the specified error code.
   private function InternalFormatError( variable i_intErrorCode) variable
   {
      // " ErrorCode=", ReturnValue, " \"", 0, "\""
      variable strErrorFormated("ErrorCode=" + IStr( i_intErrorCode));
      variable strErrorText("");
      if (!_EASYPICKII_COM_Application_Connection_UsedFlag)
      {
         return (strErrorFormated);
      }
      if (!_EASYPICKII_COM_Application_Connection.Application_GetErrorText( i_intErrorCode, strErrorText))
         strErrorFormated = strErrorFormated + " Message=\"" + strErrorText + "\"";
      return (strErrorFormated);
   }

   // Function traces an error message for the specified error code.
   private function InternalTraceError( variable i_intErrorCode, variable i_strFunctionName)
   {
      //FormatTrace( FMT_SRC, i_strFunctionName, FmtStatus::Error, i_strFunctionName, " ", InternalFormatError( i_intErrorCode));
      FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, i_strFunctionName, " ", InternalFormatError( i_intErrorCode));
   }

   // Function traces an error message for a invalid parameter
   private function InternalInvalidParameterError( variable i_strParameterName, variable i_strFunctionName) variable
   {
      if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
      {
         variable strErrorText;
         strErrorText = "The parameter '" + i_strParameterName + "' is incorrect.";
         FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, i_strFunctionName,
            " ReturnValue=", ERROR::GENERAL::_LIBRARY,
            ": ", strErrorText);
      }
      return (ERROR::GENERAL::_LIBRARY);
   }

   // This function returns hslFalse (int 0) if the value is zero, otherwise hslTrue (int 1).
   // This is necessary for boolean parameters returned by COM. In COM, true is int -1.
   //
   // Without this conversion, the comparison (parameter == hslTrue) is always false.
   //
   private function ConvertToBoolean( variable i_intValue) variable
   {
      if (i_intValue)
         return (hslTrue);
      else
         return (hslFalse);
   }



   namespace INIT
   {
      // Initialisiert die Verbindung zur Application
      function Init(
                     device   & ML_STAR,
                     variable i_intTraceLevel,
                     variable i_blnInitApplication
                   ) variable
      {

         // init trace levels
         gEasyPickII_intTraceLevel = i_intTraceLevel;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                        "( i_intTraceLevel=",i_intTraceLevel,
                        ", i_blnInitApplication=",i_blnInitApplication,
                        ")");

         // Library Version
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                        " EasyPickII Library Version=\"", LibraryVersion,"\"");

         // Setzen des Simulations-Modus
         _EASYPICKII_SimulationMode = _SIMULATION_MODE_OFF;
         if (ML_STAR.IsNullDevice()==hslFalse)
         {
            // simulationMode, 1 = simulate, 0 = execute
            if (ML_STAR.GetCfgValueWithKey(18)==1)
               _EASYPICKII_SimulationMode = _SIMULATION_MODE_ON;
         }

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                        " SimulationMode=",_EASYPICKII_SimulationMode);

         if (i_blnInitApplication)
         {
            timer timerApplicationStart;
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
               FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                           " Instantiation of ", EasyPickIIProgID," ...");
            // create connection object
            onerror goto com_load_error;
            _EASYPICKII_COM_Application_Connection.CreateObject( EasyPickIIProgID);
            // Wait short time
            timerApplicationStart.SetTimer(_COM_INITIALISATION_DELAY);
            timerApplicationStart.WaitTimer(hslFalse, hslFalse);
            _EASYPICKII_COM_Application_Connection_UsedFlag = hslTrue;
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," Instantiation succeeded");
         }

         // Anzeigen der Programmversion
         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslTrue)
         {
            variable intErrorCode;
            variable strVersion("");
            intErrorCode = _EASYPICKII_COM_Application_Connection.Application_GetVersion( strVersion);

            if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( intErrorCode, GetFunctionName());

            if (intErrorCode)
               return (intErrorCode);

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                           " Application Version=\"",strVersion,"\"");
         }

         return (ERROR::_NONE);

         // COM-Object kann nicht instansiert werden
         com_load_error:
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                           " Initialisation failed!");
            return (ERROR::GENERAL::_LIBRARY);
         }
      }
      // ------------------------------------------------------------------------------------------

      // DeInitialisierung
      function DeInit() variable
      {
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag == hslTrue)
         {
            _EASYPICKII_COM_Application_Connection.ReleaseObject();
            _EASYPICKII_COM_Application_Connection_UsedFlag = hslFalse;
         }

         return (ERROR::_NONE);
      }
      // ------------------------------------------------------------------------------------------

      // SetSimulationMode() ----------------------------------------------------------------------
      // Setzen des Simulations-Modus
      function SetSimulationMode(
                                  variable i_blnSimulationMode             // Gewuenschter Simulations-Mode
                                ) variable                             // Return: ReturnValue
      {

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"( ",
                                                                                  "i_blnSimulationMode=",i_blnSimulationMode,
                                                                               ")");

         _EASYPICKII_SimulationMode = i_blnSimulationMode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," _SimulationMode=",_EASYPICKII_SimulationMode);

         return (ERROR::_NONE);
      }
      // ------------------------------------------------------------------------------------------

      // GetSimulationMode() ----------------------------------------------------------------------
      // Lesen des Simulations-Modus
      function GetSimulationMode(
                                  variable & o_blnSimulationMode           // Simulations-Mode
                                ) variable                             // Return: ReturnValue
      {

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"(...)");

         o_blnSimulationMode = _EASYPICKII_SimulationMode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," o_blnSimulationMode=",o_blnSimulationMode);

         return (ERROR::_NONE);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace INIT

   namespace APPLICATION
   {

      // IsRunning() ------------------------------------------------------------------------------
      function IsRunning(
                          variable & o_blnApplicationRunningFlag    // Applikation RunningFlag
                        ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnApplicationRunningFlag = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Application_IsRunning( o_blnApplicationRunningFlag);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());

         o_blnApplicationRunningFlag = ConvertToBoolean( o_blnApplicationRunningFlag);


         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ", o_blnApplicationRunningFlag=",o_blnApplicationRunningFlag);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetStartError() --------------------------------------------------------------------------
      // Ermittelt einen allfaelligen Fehler beim Starten der Applikation
      function GetApplicationStartError(
                                         variable & o_intApplicationStartError     // Applikation Start Error
                                       ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_intApplicationStartError = 0;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Application_GetStartError( o_intApplicationStartError);

         // Trace error
         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (o_intApplicationStartError != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( o_intApplicationStartError, GetFunctionName());


         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ", o_intApplicationStartError=", o_intApplicationStartError);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetErrorText() ----------------------------------------------------
      function GetErrorText(
                  variable i_intErrorCode,
                  variable & o_strErrorMessage
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intErrorCode=",i_intErrorCode,
               ",...)");

         o_strErrorMessage = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            o_strErrorMessage = "The Application is not running!" +
               " Error message cannot be resolved for error code " + IStr(i_intErrorCode);
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Application_GetErrorText( i_intErrorCode, o_strErrorMessage);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strErrorMessage=\"",o_strErrorMessage,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Get_ProgrammPath() ----------------------------------------------------------------
      // Lesen des Programm Path
      function Get_ProgrammPath(
                                 variable & o_strProgrammPath    // Programm - Path
                               ) variable                    // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_strProgrammPath = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Application_Get_ProgrammPath( o_strProgrammPath);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());


         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strProgrammPath=\"",o_strProgrammPath,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace APPLICATION

   namespace APPLICATIONSETTINGS
   {

      // Get_DatabasePicturePath() ----------------------------------------------------------------
      // Lesen des Database Picture Path
      function Get_DatabasePicturePath(
                                        variable & o_strDatabasePicturePath    // Database Picture Path
                                      ) variable                           // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_strDatabasePicturePath = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ApplicationSettings_Get_DatabasePicturePath( o_strDatabasePicturePath);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strDatabasePicturePath=\"", o_strDatabasePicturePath,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace APPLICATIONSETTINGS

   namespace GUI
   {

      // Show() -----------------------------------------------------------------------------------
      // Zeigt das Applikationsfenster
      function Show(
                     variable i_intMode
                   ) variable      // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                "i_intMode=",i_intMode,
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_Show( i_intMode);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Hide() -----------------------------------------------------------------------------------
      function Hide() variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( )");

         if (!_EASYPICKII_COM_Application_Connection_UsedFlag)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_Hide();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());


         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // IsVisible() ------------------------------------------------------------------------------
      // Ist die Applikation noch sichtbar
      function IsVisible(
                          variable & o_blnIsVisible
                        ) variable      // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnIsVisible = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_IsVisible( o_blnIsVisible);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());

         o_blnIsVisible = ConvertToBoolean( o_blnIsVisible);

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnIsVisible=",o_blnIsVisible);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      namespace LIVEVIEW
      {

         // Show() ---------------------------------------------------------------------------------
         // Zeigt das LiveView
         function Show(
                       variable i_intMode
                     ) variable      // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_intMode=", i_intMode,
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Show( i_intMode);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Hide() ---------------------------------------------------------------------------------
         // Verbirgt das LiveView
         function Hide(
                     ) variable      // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( )");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Hide();

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // IsVisible() ----------------------------------------------------------------------------
         // Ist das LiveView noch sichtbar
         function IsVisible(
                            variable & o_blnIsVisible
                          ) variable      // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

            o_blnIsVisible = hslFalse;

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_IsVisible( o_blnIsVisible);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());

            o_blnIsVisible = ConvertToBoolean( o_blnIsVisible);


            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                  ", o_blnIsVisible=", o_blnIsVisible);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // SavePicture() --------------------------------------------------------------------------
         // Aktuelles Live-Bild speichern (inkl. Draw-Funktionen)
         function SavePicture(
                              variable i_strPictureFilename,     // Name des Bildes
                              variable i_strPictureFormat,       // Picture Format
                              variable i_intPictureSize_pct
                            ) variable                      // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strPictureFilename=\"",i_strPictureFilename,"\"",
                                                                                  ", i_strPictureFormat=\"",i_strPictureFormat,"\"",
                                                                                  ", i_intPictureSize_pct=",i_intPictureSize_pct,
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_SavePicture(i_strPictureFilename,
                                                                                        i_strPictureFormat,
                                                                                        i_intPictureSize_pct);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_ClearAll() ------------------------------------------------------------------------
         // LiveView Draw Function: ClearAll
         function Draw_ClearAll() variable      // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_ClearAll();

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Clear() ---------------------------------------------------------------------------
         // LiveView Draw Function: Clear
         function Draw_Clear(
                             variable i_strObjectName      // Name des Objects
                           ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Clear(i_strObjectName);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Cross() ---------------------------------------------------------------------------
         // LiveView Draw Function: Cross
         function Draw_Cross(
                             variable i_strObjectName,     // Name des Objects
                             variable i_fltPositionX_pct,      // PositionX [Prozent]
                             variable i_fltPositionY_pct,      // PositionY [Prozent]
                             variable i_fltSize_pct,           // Size [Prozent]
                             variable i_fltAngle_deg,          // Angle
                             variable i_strColor,          // Color
                             variable i_intLineWidth        // LineSize
                           ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ",i_fltPositionX_pct=",i_fltPositionX_pct,
                                                                                  ",i_fltPositionY_pct=",i_fltPositionY_pct,
                                                                                  ",i_fltSize_pct=",i_fltSize_pct,
                                                                                  ",i_fltAngle_deg=",i_fltAngle_deg,
                                                                                  ",i_strColor=\"",i_strColor,"\"",
                                                                                  ",i_intLineWidth=",i_intLineWidth,
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Cross(i_strObjectName,
                                                                                       i_fltPositionX_pct,
                                                                                       i_fltPositionY_pct,
                                                                                       i_fltSize_pct,
                                                                                       i_fltAngle_deg,
                                                                                       i_strColor,
                                                                                       i_intLineWidth);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Ellipse() -------------------------------------------------------------------------
         // LiveView Draw Function: Ellipse
         function Draw_Ellipse(
                               variable i_strObjectName,     // Name des Objects
                               variable i_fltPositionX_pct,      // PositionX [Prozent]
                               variable i_fltPositionY_pct,      // PositionY [Prozent]
                               variable i_fltSizeX_pct,          // SizeX [Prozent]
                               variable i_fltSizeY_pct,          // SizeY [Prozent]
                               variable i_fltAngle_deg,          // Angle
                               variable i_strColor,          // Color
                               variable i_intLineWidth,       // LineSize
                               variable i_strDrawMode        // DrawMode
                             ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ", i_fltPositionX_pct=",i_fltPositionX_pct,
                                                                                  ", i_fltPositionY_pct=",i_fltPositionY_pct,
                                                                                  ", i_fltSizeX_pct=",i_fltSizeX_pct,
                                                                                  ", i_fltSizeY_pct=",i_fltSizeY_pct,
                                                                                  ", i_fltAngle_deg=",i_fltAngle_deg,
                                                                                  ", i_strColor=\"",i_strColor,"\"",
                                                                                  ", i_intLineWidth=",i_intLineWidth,
                                                                                  ", i_strDrawMode=\"",i_strDrawMode,"\"",
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Ellipse(i_strObjectName,
                                                                                         i_fltPositionX_pct,
                                                                                         i_fltPositionY_pct,
                                                                                         i_fltSizeX_pct,
                                                                                         i_fltSizeY_pct,
                                                                                         i_fltAngle_deg,
                                                                                         i_strColor,
                                                                                         i_intLineWidth,
                                                                                         i_strDrawMode);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Rectangle() -----------------------------------------------------------------------
         // LiveView Draw Function: Rectangle
         function Draw_Rectangle(
                                 variable i_strObjectName,     // Name des Objects
                                 variable i_fltPositionX_pct,      // PositionX [Prozent]
                                 variable i_fltPositionY_pct,      // PositionY [Prozent]
                                 variable i_fltSizeX_pct,          // SizeX [Prozent]
                                 variable i_fltSizeY_pct,          // SizeY [Prozent]
                                 variable i_fltAngle_deg,          // Angle
                                 variable i_strColor,          // Color
                                 variable i_intLineWidth,       // LineSize
                                 variable i_strDrawMode        // DrawMode
                               ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ", i_fltPositionX_pct=",i_fltPositionX_pct,
                                                                                  ", i_fltPositionY_pct=",i_fltPositionY_pct,
                                                                                  ", i_fltSizeX_pct=",i_fltSizeX_pct,
                                                                                  ", i_fltSizeY_pct=",i_fltSizeY_pct,
                                                                                  ", i_fltAngle_deg=",i_fltAngle_deg,
                                                                                  ", i_strColor=\"",i_strColor,"\"",
                                                                                  ", i_intLineWidth=",i_intLineWidth,
                                                                                  ", i_strDrawMode=\"",i_strDrawMode,"\"",
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Rectangle(i_strObjectName,
                                                                                           i_fltPositionX_pct,
                                                                                           i_fltPositionY_pct,
                                                                                           i_fltSizeX_pct,
                                                                                           i_fltSizeY_pct,
                                                                                           i_fltAngle_deg,
                                                                                           i_strColor,
                                                                                           i_intLineWidth,
                                                                                           i_strDrawMode);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Line() ----------------------------------------------------------------------------
         // LiveView Draw Function: Line
         function Draw_Line(
                            variable i_strObjectName,     // Name des Objects
                            variable i_fltX1_pct,     // Position 1 X [Prozent]
                            variable i_fltY1_pct,     // Position 1 Y [Prozent]
                            variable i_fltX2_pct,     // Position 2 X [Prozent]
                            variable i_fltY2_pct,     // Position 2 Y [Prozent]
                            variable i_strColor,          // Color
                            variable i_intLineWidth        // LineSize
                          ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                  "( i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ", i_fltX1_pct=",i_fltX1_pct,
                                                                                  ", i_fltY1_pct=",i_fltY1_pct,
                                                                                  ", i_fltX2_pct=",i_fltX2_pct,
                                                                                  ", i_fltY2_pct=",i_fltY2_pct,
                                                                                  ", i_strColor=\"",i_strColor,"\"",
                                                                                  ", i_intLineWidth=",i_intLineWidth,
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Line(i_strObjectName,
                                                                                      i_fltX1_pct,
                                                                                      i_fltY1_pct,
                                                                                      i_fltX2_pct,
                                                                                      i_fltY2_pct,
                                                                                      i_strColor,
                                                                                      i_intLineWidth);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

         // Draw_Text() ----------------------------------------------------------------------------
         // LiveView Draw Function: Text
         function Draw_Text(
                            variable i_strObjectName,     // Name des Objects
                            variable i_fltPositionX_pct,      // PositionX [Prozent]
                            variable i_fltPositionY_pct,      // PositionY [Prozent]
                            variable i_strText,           // Text
                            variable i_strColor,          // Color
                            variable i_strFontName,       // FontName
                            variable i_intTextSize        // TextSize
                          ) variable                  // Return: ReturnValue
        {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                  "i_strObjectName=\"",i_strObjectName,"\"",
                                                                                  ", i_fltPositionX_pct=",i_fltPositionX_pct,
                                                                                  ", i_fltPositionY_pct=",i_fltPositionY_pct,
                                                                                  ", i_strText=\"",i_strText,"\"",
                                                                                  ", i_strColor=\"",i_strColor,"\"",
                                                                                  ", i_strFontName=\"",i_strFontName,"\"",
                                                                                  ", i_intTextSize=",i_intTextSize,
                                                                                  ")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_LiveView_Draw_Text(i_strObjectName,
                                                                                      i_fltPositionX_pct,
                                                                                      i_fltPositionY_pct,
                                                                                      i_strText,
                                                                                      i_strColor,
                                                                                      i_strFontName,
                                                                                      i_intTextSize);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ----------------------------------------------------------------------------------------

      } // namespace LIVEVIEW


      namespace PICTUREVIEW
      {
         // Clear
         // ShowColony()

         // Colonies_DisplayColony() -----------------------------------------------------------------
         // Zeigt das aktuelle Colony an
         function DisplayColony( variable i_intColonyID ) variable
         {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"( ","i_intColonyID=", i_intColonyID,")");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_PictureView_DisplayColony( i_intColonyID);

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ------------------------------------------------------------------------------------------

         // Colonies_DisplayColonyClearList() --------------------------------------------------------
         // Loescht die aktuelle Colony Liste
         // Return: ErrorCode
         function Clear() variable
         {
            variable ReturnValue;

            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"( )");

            if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
            {
               if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
               return (ERROR::GENERAL::_APPLICATION);
            }

            ReturnValue = _EASYPICKII_COM_Application_Connection.GUI_PictureView_Clear();

            if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               InternalTraceError( ReturnValue, GetFunctionName());
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue);

            return (ReturnValue);
         }
         // ------------------------------------------------------------------------------------------


      } // namespace PICTUREVIEW

   } // namespace GUI

   namespace CAMERA
   {

      // Open() -----------------------------------------------------------------------------------
      // Oeffnen der Camera
      function Open(
                     variable i_strCameraSettingsName      // Name der Settings
                   ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                " i_strCameraSettingsName=\"",i_strCameraSettingsName,"\"",
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strCameraSettingsName))
            return (InternalInvalidParameterError( "i_strCameraSettingsName", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_Open( i_strCameraSettingsName);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Close() ----------------------------------------------------------------------------------
      // Schliessen der Camera
      function Close(
                    ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( )");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_Close();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // IsOpen() ---------------------------------------------------------------------------------
      // Camera Open Check
      function IsOpen(
                       variable & o_blnCameraIsOpen         // Camera open flag
                     ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnCameraIsOpen = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_IsOpen( o_blnCameraIsOpen);

         o_blnCameraIsOpen = ConvertToBoolean( o_blnCameraIsOpen);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnCameraIsOpen=",o_blnCameraIsOpen);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // TakePicture() ----------------------------------------------------------------------------
      // Erstellen eines Bildes
      function TakePicture(
                          ) variable                       // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_TakePicture();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SavePicture() ----------------------------------------------------------------------------
      // Erstelltes Bildes speichern
      function SavePicture(
                            variable i_strPictureFilename,     // Name des Bildes
                            variable i_strPictureFormat,       // Picture Format
                            variable i_intPictureSize_pct
                          ) variable                      // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_strPictureFilename=\"", i_strPictureFilename,"\"",
                                                                                ", i_strPictureFormat=\"",i_strPictureFormat,"\"",
                                                                                ", i_intPictureSize_pct=",i_intPictureSize_pct,
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strPictureFilename))
            return (InternalInvalidParameterError( "i_strPictureFilename", GetFunctionName()));
         if (!Util::IsString( i_strPictureFormat))
            return (InternalInvalidParameterError( "i_strPictureFormat", GetFunctionName()));
         if (!Util::IsInteger( i_intPictureSize_pct))
            return (InternalInvalidParameterError( "i_intPictureSize_pct", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_SavePicture(i_strPictureFilename,
                                                                                i_strPictureFormat,
                                                                                i_intPictureSize_pct);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // LoadPicture() ----------------------------------------------------------------------------
      // Erstelltes Bildes speichern
      function LoadPicture(
                            variable i_strPictureFilename     // Name des Bildes
                          ) variable                      // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                "i_strPictureFilename=\"",i_strPictureFilename,"\"",
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strPictureFilename))
            return (InternalInvalidParameterError( "i_strPictureFilename", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Camera_LoadPicture(i_strPictureFilename);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace CAMERA

   namespace SETTINGS
   {

      // SelectCameraSettings() -------------------------------------------------------------------
      // Aussuchen der Camera Settings
      function SelectCameraSettings(
                                      variable i_strDefaultCameraSettingsName, // Name der Vorgabe-Settings
                                      variable & o_strCameraSettingsName       // Name der Settings
                                    ) variable                            // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                "i_strDefaultCameraSettingsName=\"",i_strDefaultCameraSettingsName,"\"",
                                                                                ",...)");

         if (!Util::IsString( i_strDefaultCameraSettingsName))
            return (InternalInvalidParameterError( "i_strDefaultCameraSettingsName", GetFunctionName()));

         o_strCameraSettingsName = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_SelectCameraSettings( i_strDefaultCameraSettingsName,
                                                                                            o_strCameraSettingsName);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strCameraSettingsName=\"",o_strCameraSettingsName,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SelectColonySettings() ------------------------------------------------------------------
      // Aussuchen der Colony Settings
      function SelectColonySettings(
                                      variable i_strDefaultColonySettingsName,  // Name der Vorgabe-Settings
                                      variable & o_strColonySettingsName        // Name der Settings
                                    ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                "i_strDefaultColonySettingsName=\"",i_strDefaultColonySettingsName,"\"",
                                                                                ",...)");

         if (!Util::IsString( i_strDefaultColonySettingsName))
            return (InternalInvalidParameterError( "i_strDefaultColonySettingsName", GetFunctionName()));

         o_strColonySettingsName = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_SelectColonySettings(i_strDefaultColonySettingsName,
                                                                                            o_strColonySettingsName);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strColonySettingsName=\"",o_strColonySettingsName,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // SelectColonySettings() ------------------------------------------------------------------
      function SelectImageStitcherSettings(
                                      variable i_strDefaultImageStitcherSettingsName,  // Name der Vorgabe-Settings
                                      variable & o_strImageStitcherSettingsName        // Name der Settings
                                    ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
                                                                                "i_strDefaultImageStitcherSettingsName=\"",i_strDefaultImageStitcherSettingsName,"\"",
                                                                                ",...)");

         if (!Util::IsString( i_strDefaultImageStitcherSettingsName))
            return (InternalInvalidParameterError( "i_strDefaultImageStitcherSettingsName", GetFunctionName()));

         o_strImageStitcherSettingsName = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_SelectImageStitcherSettings( i_strDefaultImageStitcherSettingsName,
                                                                                            o_strImageStitcherSettingsName);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_strImageStitcherSettingsName=\"",o_strImageStitcherSettingsName,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetCameraSettingsNamesList() ------------------------------------------------------------------
      function GetCameraSettingsNamesList(
                  variable& o_arrstrCameraSettingsNames[]
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
               "...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_GetCameraSettingsNamesList(
                           o_arrstrCameraSettingsNames);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) 
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), 
               " ReturnValue=",ReturnValue,
               ", o_arrstrCameraSettingsNames=\"", HELPER::ArrayToString( o_arrstrCameraSettingsNames),"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetColonySettingsNamesList() ------------------------------------------------------------------
      function GetColonySettingsNamesList(
                  variable& o_arrstrColonySettingsNames[]
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
               "...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_GetColonySettingsNamesList(
                           o_arrstrColonySettingsNames);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) 
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), 
               " ReturnValue=",ReturnValue,
               ", o_arrstrColonySettingsNames=\"", HELPER::ArrayToString( o_arrstrColonySettingsNames),"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------
      
      // GetImageStitcherSettingsNamesList() ------------------------------------------------------------------
      function GetImageStitcherSettingsNamesList(
                  variable& o_arrstrImageStitcherSettingsNames[]
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "( ",
               "...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Settings_GetImageStitcherSettingsNamesList(
                           o_arrstrImageStitcherSettingsNames);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) 
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), 
               " ReturnValue=",ReturnValue,
               ", o_arrstrImageStitcherSettingsNames=\"", HELPER::ArrayToString( o_arrstrImageStitcherSettingsNames),"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Instrument_SetChannelOffset() -------------------------------------------------------
      //
      function Instrument_SetChannelOffset(
                  variable i_intChannelNumber,
                  variable i_fltOffsetX_mm,
                  variable i_fltOffsetY_mm
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                            "( i_intChannelNumber=",i_intChannelNumber,
                                                            ", i_fltOffsetX_mm=",i_fltOffsetX_mm,
                                                            ", i_fltOffsetY_mm=",i_fltOffsetY_mm,")");

         if (!Util::IsInteger( i_intChannelNumber))
            return (InternalInvalidParameterError( "i_intChannelNumber", GetFunctionName()));
         if (!Util::IsNumber( i_fltOffsetX_mm))
            return (InternalInvalidParameterError( "i_fltOffsetX_mm", GetFunctionName()));
         if (!Util::IsNumber( i_fltOffsetY_mm))
            return (InternalInvalidParameterError( "i_fltOffsetY_mm", GetFunctionName()));

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Instrument_SetChannelOffset(
                              i_intChannelNumber,
                              i_fltOffsetX_mm,
                              i_fltOffsetY_mm);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Instrument_GetChannelOffset() -------------------------------------------------------
      //
      function Instrument_GetChannelOffset(
                  variable i_intChannelNumber,
                  variable & o_fltOffsetX_mm,
                  variable & o_fltOffsetY_mm
                  ) variable
      {
         variable ReturnValue;
         variable FMT_ACTION("Instrument_GetChannelOffset");

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Start, GetFunctionName(),
                                                            "( i_intChannelNumber=",i_intChannelNumber,",...",")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intChannelNumber))
            return (InternalInvalidParameterError( "i_intChannelNumber", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Instrument_GetChannelOffset(
                           i_intChannelNumber,
                           o_fltOffsetX_mm,
                           o_fltOffsetY_mm);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) 
            FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Complete, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ",o_fltOffsetX_mm=",o_fltOffsetX_mm,
               ",o_fltOffsetY_mm=",o_fltOffsetY_mm);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------



   } // namespace SETTINGS

   namespace ANALYSE
   {

      // Start() ----------------------------------------------------------------------------------
      // Startet die Analyse des Barocdes
      function Start(
                      variable i_strColonySettingsName
                    ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                            "( i_strColonySettingsName=\"", i_strColonySettingsName,"\"",
                                                                                ")");

         if (!Util::IsString( i_strColonySettingsName))
            return (InternalInvalidParameterError( "i_strColonySettingsName", GetFunctionName()));

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_Start( i_strColonySettingsName);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // Stop() -----------------------------------------------------------------------------------
      // Stoppt die Analyse des Barocdes
      function Stop(
                   ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_Stop();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Reset() ----------------------------------------------------------------------------------
      // Resettet die Analyse des Barocdes
      function Reset(
                    ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_Reset();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // CheckRunning() ---------------------------------------------------------------------------
      // Check Finish Analyse des Colonys
      function CheckRunning(
                             variable & o_blnRunning
                           ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnRunning = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_CheckRunning( o_blnRunning);

         o_blnRunning = ConvertToBoolean( o_blnRunning);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnRunning=", o_blnRunning);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ------------------------------------------------------------------------------------------
      function SetAgarHeight(
                  variable i_fltAgarHeightRelativeToReferencePlane_mm
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_fltAgarHeightRelativeToReferencePlane_mm=", i_fltAgarHeightRelativeToReferencePlane_mm,
               ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.AnalyseColonies_SetAgarheight(
            i_fltAgarHeightRelativeToReferencePlane_mm);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               "");

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------


      // ------------------------------------------------------------------------------------------
      function GetLLDPosition(
                  variable  i_blnSelectByOperator,
                  variable  i_intChannelNumber,
                  variable& o_fltPositionX_mm,
                  variable& o_fltPositionY_mm
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_blnSelectByOperator=", i_blnSelectByOperator,
               ", i_intChannelNumber=", i_intChannelNumber,
               ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.AnalyseColonies_GetLLDPosition(
            i_blnSelectByOperator,
            i_intChannelNumber,
            o_fltPositionX_mm,
            o_fltPositionY_mm);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               ", o_fltPositionX_mm=", o_fltPositionX_mm,
               ", o_fltPositionY_mm=", o_fltPositionY_mm);

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------


      // ------------------------------------------------------------------------------------------
      function UserEditColonies() variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.AnalyseColonies_UserEditColonies( );

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               "");

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------


      // SaveResult() -----------------------------------------------------------------------------
      // Save Result of colony analyser
      function SaveResult(
                           variable i_blnAsynchronPictureSave,
                           variable i_strRackBarcode,
                           variable i_strDescription,
                           variable & o_intRackID
                         ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_blnAsynchronPictureSave=",i_blnAsynchronPictureSave,
               ", i_strRackBarcode=\"",i_strRackBarcode,"\"",
               ", i_strDescription=\"",i_strDescription,"\"",
               ",...)");

         o_intRackID = _DATABASE_RETURN_VALUE_NO_ID_FOUND;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_blnAsynchronPictureSave))
            return (InternalInvalidParameterError( "i_blnAsynchronPictureSave", GetFunctionName()));
         if (!Util::IsString( i_strRackBarcode))
            return (InternalInvalidParameterError( "i_strRackBarcode", GetFunctionName()));
         if (!Util::IsString( i_strDescription))
            return (InternalInvalidParameterError( "i_strDescription", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_SaveResult(i_blnAsynchronPictureSave,
                                                                                       i_strRackBarcode,
                                                                                       i_strDescription,
                                                                                       o_intRackID);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_intRackID=",o_intRackID);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SaveResult_CheckAsynchronSaving() --------------------------------------------------------
      // Check Finish Saving Results by Asynchron mode
      function SaveResult_CheckAsynchronSaveFinish(
                                                    variable & o_blnFinish               // Finish-Flag
                                                  ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnFinish = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_SaveResult_CheckAsynchronSaveFinish( o_blnFinish);

         o_blnFinish = ConvertToBoolean( o_blnFinish);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnFinish=",o_blnFinish);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ExportRackPicture() ----------------------------------------------------------------------
      // Export rack picture
      function ExportRackPicture(
                                  variable i_intRackID,
                                  variable i_blnAsynchronPictureSave,
                                  variable i_strPictureFilename,
                                  variable i_strPictureFormat,
                                  variable i_blnPictureCropped,
                                  variable i_intPictureSize_pct
                                ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                       "( i_intRackID=",i_intRackID,
                       ", i_blnAsynchronPictureSave=",i_blnAsynchronPictureSave,
                       ", i_strPictureFilename=\"",i_strPictureFilename,"\"",
                       ", i_strPictureFormat=\"",i_strPictureFormat,"\"",
                       ", i_blnPictureCropped=",i_blnPictureCropped,
                       ", i_intPictureSize_pct=",i_intPictureSize_pct,
                       ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_blnAsynchronPictureSave))
            return (InternalInvalidParameterError( "i_blnAsynchronPictureSave", GetFunctionName()));
         if (!Util::IsString( i_strPictureFilename))
            return (InternalInvalidParameterError( "i_strPictureFilename", GetFunctionName()));
         if (!Util::IsString( i_strPictureFormat))
            return (InternalInvalidParameterError( "i_strPictureFormat", GetFunctionName()));
         if (!Util::IsInteger( i_blnPictureCropped))
            return (InternalInvalidParameterError( "i_blnPictureCropped", GetFunctionName()));
         if (!Util::IsInteger( i_intPictureSize_pct))
            return (InternalInvalidParameterError( "i_intPictureSize_pct", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_ExportRackPicture(
                           i_intRackID,
                           i_blnAsynchronPictureSave,
                           i_strPictureFilename,
                           i_strPictureFormat,
                           i_blnPictureCropped,
                           i_intPictureSize_pct,
                           hslFalse);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ExportRackPicture() ----------------------------------------------------------------------
      // Export rack picture
      function ExportRackPicture2(
                                  variable i_intRackID,
                                  variable i_blnAsynchronPictureSave,
                                  variable i_strPictureFilename,
                                  variable i_strPictureFormat,
                                  variable i_blnPictureCropped,
                                  variable i_intPictureSize_pct,
                                  variable i_blnAnalyserDrawings
                                ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                       "( i_intRackID=",i_intRackID,
                       ", i_blnAsynchronPictureSave=", i_blnAsynchronPictureSave,
                       ", i_strPictureFilename=\"", i_strPictureFilename,"\"",
                       ", i_strPictureFormat=\"", i_strPictureFormat,"\"",
                       ", i_blnPictureCropped=", i_blnPictureCropped,
                       ", i_intPictureSize_pct=", i_intPictureSize_pct,
                       ", i_blnAnalyserDrawings=", i_blnAnalyserDrawings,
                       ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_blnAsynchronPictureSave))
            return (InternalInvalidParameterError( "i_blnAsynchronPictureSave", GetFunctionName()));
         if (!Util::IsString( i_strPictureFilename))
            return (InternalInvalidParameterError( "i_strPictureFilename", GetFunctionName()));
         if (!Util::IsString( i_strPictureFormat))
            return (InternalInvalidParameterError( "i_strPictureFormat", GetFunctionName()));
         if (!Util::IsInteger( i_blnPictureCropped))
            return (InternalInvalidParameterError( "i_blnPictureCropped", GetFunctionName()));
         if (!Util::IsInteger( i_intPictureSize_pct))
            return (InternalInvalidParameterError( "i_intPictureSize_pct", GetFunctionName()));
         if (!Util::IsInteger( i_blnAnalyserDrawings))
            return (InternalInvalidParameterError( "i_blnAnalyserDrawings", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_ExportRackPicture(
                           i_intRackID,
                           i_blnAsynchronPictureSave,
                           i_strPictureFilename,
                           i_strPictureFormat,
                           i_blnPictureCropped,
                           i_intPictureSize_pct,
                           i_blnAnalyserDrawings);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ExportColonyResults() ----------------------------------------------------------------------
      // Export colony results
      function ExportColonyResults(
          variable i_intRackID,
          variable i_strReportPathName,
          variable i_strReportFormat
        ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intRackID=",i_intRackID,
               ", i_strReportPathName=\"",i_strReportPathName,"\"",
               ", i_strReportFormat=\"",i_strReportFormat,"\"",
               ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsString( i_strReportPathName))
            return (InternalInvalidParameterError( "i_strReportPathName", GetFunctionName()));
         if (!Util::IsString( i_strReportFormat))
            return (InternalInvalidParameterError( "i_strReportFormat", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.AnalyseColonies_ExportColonyResults(i_intRackID,
                                                                                              i_strReportPathName,
                                                                                              i_strReportFormat);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ExportToZipArchive() ---------------------------------------------------------------------
      function ExportToZipArchive(
                  variable i_arrintRackIDs[],
                  variable i_strZipFileName,
                  variable i_blnAppend
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_arrintRackIDs=", HELPER::ArrayIntToString(i_arrintRackIDs),
               ", i_strZipFileName=\"",i_strZipFileName,"\"",
               ", i_blnAppend=",i_blnAppend,
               ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(), " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.AnalyseColonies_ExportToZipArchive(
                           i_arrintRackIDs,
                           i_strZipFileName,
                           i_blnAppend);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",intErrorCode);

      return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace ANALYSE

   namespace IMAGE_STITCHER
   {
      // Start() ----------------------------------------------------------------------------------
      // Assigns the current picture to a picture position for the image stitcher.
      // i_intPositionIndex: position in range 0..5
      function AssignPicturePosition(
                      variable i_intPositionIndex
                    ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intPositionIndex=",i_intPositionIndex,
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intPositionIndex)) return (InternalInvalidParameterError( "i_intPositionIndex", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_AssignPicturePosition( i_intPositionIndex);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Start() ----------------------------------------------------------------------------------
      function Start(
                      variable i_strSettingNameStitcher
                    ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_strSettingNameStitcher=\"", i_strSettingNameStitcher,"\"",
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strSettingNameStitcher))
            return (InternalInvalidParameterError( "i_strSettingNameStitcher", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_Start( i_strSettingNameStitcher);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Start2() ----------------------------------------------------------------------------------
      function Start2(
                      variable i_strSettingNameStitcher,
                      variable i_fltAgarHeightBasedOnReferencePointsPlane_mm
                    ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_strSettingNameStitcher=\"", i_strSettingNameStitcher,"\"",
                                                                                ", i_fltAgarHeightBasedOnReferencePointsPlane_mm=\"", i_fltAgarHeightBasedOnReferencePointsPlane_mm,"\"",
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strSettingNameStitcher))
            return (InternalInvalidParameterError( "i_strSettingNameStitcher", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_Start2( i_strSettingNameStitcher, i_fltAgarHeightBasedOnReferencePointsPlane_mm);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Stop() -----------------------------------------------------------------------------------
      // Stoppt die Analyse des Barocdes
      function Stop(
                   ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_Stop();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Reset() ----------------------------------------------------------------------------------
      // Resettet die Analyse des Barocdes
      function Reset(
                    ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "()");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_Reset();

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // CheckRunning() ---------------------------------------------------------------------------
      // Check Finish Analyse des Colonys
      function CheckRunning(
                             variable & o_blnRunning              // Running-Flag
                           ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnRunning = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_CheckRunning( o_blnRunning);

         o_blnRunning = ConvertToBoolean( o_blnRunning);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnRunning=", o_blnRunning);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SaveResult() -----------------------------------------------------------------------------
      // Save Result of analysed bar code
      function SaveResult(
                           variable i_blnAsynchronPictureSave,
                           variable i_strRackBarcode,
                           variable i_strDescription,
                           variable i_blnSaveInputPictures,
                           variable i_blnSaveOutputPicture,
                           variable & o_intImageStitcherID
                         ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_blnAsynchronPictureSave=",i_blnAsynchronPictureSave,
                                                                                ", i_strRackBarcode=\"",i_strRackBarcode,"\"",
                                                                                ", i_strDescription=\"",i_strDescription,"\"",
                                                                                ", i_blnSaveInputPictures=",i_blnSaveInputPictures,
                                                                                ", i_blnSaveOutputPicture=",i_blnSaveOutputPicture,
                                                                                ",...)");

         o_intImageStitcherID = _DATABASE_RETURN_VALUE_NO_ID_FOUND;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_blnAsynchronPictureSave))
            return (InternalInvalidParameterError( "i_blnAsynchronPictureSave", GetFunctionName()));
         if (!Util::IsString( i_strRackBarcode))
            return (InternalInvalidParameterError( "i_strRackBarcode", GetFunctionName()));
         if (!Util::IsString( i_strDescription))
            return (InternalInvalidParameterError( "i_strDescription", GetFunctionName()));
         if (!Util::IsInteger( i_blnSaveInputPictures))
            return (InternalInvalidParameterError( "i_blnSaveInputPictures", GetFunctionName()));
         if (!Util::IsInteger( i_blnSaveOutputPicture))
            return (InternalInvalidParameterError( "i_blnSaveOutputPicture", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_SaveResult( i_blnAsynchronPictureSave,
                                                                                       i_strRackBarcode,
                                                                                       i_strDescription,
                                                                                       i_blnSaveInputPictures,
                                                                                       i_blnSaveOutputPicture,
                                                                                       o_intImageStitcherID);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_intImageStitcherID=",o_intImageStitcherID);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SaveResult_CheckAsynchronSaving() --------------------------------------------------------
      // Check Finish Saving Results by Asynchron mode
      function SaveResult_CheckAsynchronSaveFinish(
                                                    variable & o_blnFinish               // Finish-Flag
                                                  ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(...)");

         o_blnFinish = hslFalse;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_SaveResult_CheckAsynchronSaveFinish( o_blnFinish);

         o_blnFinish = ConvertToBoolean( o_blnFinish);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
                                                                                ", o_blnFinish=",o_blnFinish);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // ExportRackPicture() ----------------------------------------------------------------------
      // Export rack picture
      function ExportRackPicture(
                                  variable i_intImageStitcherID,
                                  variable i_blnAsynchronPictureSave,
                                  variable i_strPictureFilename,
                                  variable i_strPictureFormat,
                                  variable i_blnPictureCropped,
                                  variable i_intPictureSize_pct
                                ) variable                         // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intImageStitcherID=",i_intImageStitcherID,
                                                                                ", i_blnAsynchronPictureSave=",i_blnAsynchronPictureSave,
                                                                                ", i_strPictureFilename=\"",i_strPictureFilename,"\"",
                                                                                ", i_strPictureFormat=\"",i_strPictureFormat,"\"",
                                                                                ", i_blnPictureCropped=",i_blnPictureCropped,
                                                                                ", i_intPictureSize_pct=",i_intPictureSize_pct,
                                                                                ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.ImageStitcher_ExportRackPicture( i_intImageStitcherID,
                                                                                              i_blnAsynchronPictureSave,
                                                                                              i_strPictureFilename,
                                                                                              i_strPictureFormat,
                                                                                              i_blnPictureCropped,
                                                                                              i_intPictureSize_pct);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

   }

   namespace DATABASE
   {
      // GetEasyPickIIRack() ----------------------------------------------------------------------
      // Ermitteln der Rack Informationen
      function GetEasyPickIIRack(
                                  variable i_intRackID,
                                  variable & o_strRackBarcode,
                                  variable & o_strPictureFilename,
                                  variable & o_intContainerPositionsX,
                                  variable & o_intContainerPositionsY,
                                  variable & o_intErrorCode,
                                  variable & o_strDescription
                                ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intRackID=",i_intRackID,
                                                                                ",...)");

         o_strRackBarcode          = "";
         o_strPictureFilename      = "";
         o_intContainerPositionsX    = 0;
         o_intContainerPositionsY    = 0;
         o_intErrorCode            = ERROR::_NONE;
         o_strDescription          = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIRack( i_intRackID,
                                                                                        o_strRackBarcode,
                                                                                        o_strPictureFilename,
                                                                                        o_intContainerPositionsX,
                                                                                        o_intContainerPositionsY,
                                                                                        o_intErrorCode,
                                                                                        o_strDescription);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=", ReturnValue,
                                                                                ", o_strRackBarcode=\"",o_strRackBarcode,"\"",
                                                                                ", o_strPictureFilename=\"",o_strPictureFilename,"\"",
                                                                                ", o_intContainerPositionsX=",o_intContainerPositionsX,
                                                                                ", o_intContainerPositionsY=",o_intContainerPositionsY,
                                                                                ", o_intErrorCode=",o_intErrorCode,
                                                                                ", o_strDescription=\"",o_strDescription,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // ------------------------------------------------------------------------------------------
      function GetEasyPickIIContainerIDs(
                  variable i_intRackID,
                  variable& o_arrintContainerIDs[]
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intRackID=", i_intRackID,
               ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIContainerIDs(
                           i_intRackID,
                           o_arrintContainerIDs);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               ", o_arrintContainerIDs=", HELPER::ArrayIntToString( o_arrintContainerIDs));

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------


      // ------------------------------------------------------------------------------------------
      function GetEasyPickIIColonyIDs_IsGoodColony(
                  variable i_intContainerID,
                  variable& o_arrintColonyIDs[]
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intContainerID=", i_intContainerID,
               ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyIDs_IsGoodColony(
                           i_intContainerID,
                           o_arrintColonyIDs);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               ", o_arrintColonyIDs=", HELPER::ArrayIntToString( o_arrintColonyIDs));

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------

      // ------------------------------------------------------------------------------------------
      function GetEasyPickIIColonyIDs_IsExcludedColony(
                  variable i_intContainerID,
                  variable& o_arrintColonyIDs[]
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intContainerID=", i_intContainerID,
               ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyIDs_IsExcludedColony(
                           i_intContainerID,
                           o_arrintColonyIDs);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", intErrorCode,
               ", o_arrintColonyIDs=", HELPER::ArrayIntToString( o_arrintColonyIDs));

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------


      // SetEasyPickIIRack_Field_Description() ----------------------------------------------------
      // Setzten der Rack Description
      function SetEasyPickIIRack_Field_Description(
                                                    variable i_intRackID,
                                                    variable i_strDescription
                                                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intRackID=",i_intRackID,
                                                                                ", i_strDescription=\"",i_strDescription,"\"",
                                                                                ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsString( i_strDescription))
            return (InternalInvalidParameterError( "i_strDescription", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_SetEasyPickIIRack_Field_Description(i_intRackID,
                                                                                                          i_strDescription);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SetEasyPickIIRack_Field_Description() ----------------------------------------------------
      // Setzten der Rack Description
      function SetEasyPickIIRack_Field_ImageStitcherID(
                                                    variable i_intRackID,
                                                    variable i_intImageStitcherID
                                                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intRackID=", i_intRackID,
                                                                                ", i_intImageStitcherID=", i_intImageStitcherID,
                                                                                ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_intImageStitcherID))
            return (InternalInvalidParameterError( "i_intImageStitcherID", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_SetEasyPickIIRack_Field_ImageStitcherID(
                                                                                 i_intRackID,
                                                                                 i_intImageStitcherID);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);


         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // Retrieves the rack ID's associated with a barcode.
      //
      // Args:
      //    i_strRackBarcode (string): Rack bar code to search for.
      //    o_arrintRackIDs (array of int):  An array variable that receives
      //       the rack ID's in descending order, youngest first.
      //
      // Returns:
      //    int: Zero if successful, non-zero error code otherwise.
      //
      function GetEasyPickIIRackID_By_RackBarcode(
                     variable i_strRackBarcode,
                     variable& o_arrintRackIDs[]
                   ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_strRackBarcode=\"",i_strRackBarcode,"\"",
                                                                                ",...)");


         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsString( i_strRackBarcode))
            return (InternalInvalidParameterError( "i_strRackBarcode", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIRackID_By_RackBarcode(
                           i_strRackBarcode,
                           o_arrintRackIDs);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=", ReturnValue,
               ", o_arrintRackIDs=", HELPER::ArrayIntToString( o_arrintRackIDs));

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetEasyPickIIContainer() -----------------------------------------------------------------
      // Ermitteln der Container Informationen
      function GetEasyPickIIContainer(
                                       variable i_intContainerID,
                                       variable & o_intPositionNumber,
                                       variable & o_strPositionText,
                                       variable & o_intErrorCode,
                                       variable & o_strDescription
                                     ) variable                                     // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                           "( i_intContainerID=",i_intContainerID,
                           ",...)");

         o_intPositionNumber = 0;
         o_strPositionText   = "";
         o_intErrorCode      = ERROR::_NONE;
         o_strDescription    = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intContainerID))
            return (InternalInvalidParameterError( "i_intContainerID", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIContainer(
                           i_intContainerID,
                           o_intPositionNumber,
                           o_strPositionText,
                           o_intErrorCode,
                           o_strDescription);

         if (ReturnValue && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ", o_intPositionNumber=",o_intPositionNumber,
               ", o_strPositionText=\"",o_strPositionText,"\"",
               ", o_intErrorCode=",o_intErrorCode,
               ", o_strDescription=\"",o_strDescription,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetEasyPickIIContainer2() -----------------------------------------------------------------
      // Ermitteln der Container Informationen
      function GetEasyPickIIContainer2(
                  variable i_intContainerID,
                  variable & o_intPositionNumber,
                  variable & o_strPositionText,
                  variable & o_intPickOrder,
                  variable & o_intErrorCode,
                  variable & o_strDescription
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                           "( i_intContainerID=",i_intContainerID,
                           ",...)");

         o_intPositionNumber = 0;
         o_strPositionText   = "";
         o_intPickOrder      = 0;
         o_intErrorCode      = 0;
         o_strDescription    = "";

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intContainerID))
            return (InternalInvalidParameterError( "i_intContainerID", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIContainer2(
                           i_intContainerID,
                           o_intPositionNumber,
                           o_strPositionText,
                           o_intPickOrder,
                           o_intErrorCode,
                           o_strDescription);

         if (ReturnValue && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ", o_intPositionNumber=",o_intPositionNumber,
               ", o_strPositionText=\"",o_strPositionText,"\"",
               ", o_intPickOrder=",o_intPickOrder,
               ", o_intErrorCode=",o_intErrorCode,
               ", o_strDescription=\"",o_strDescription,"\"");

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // SetEasyPickIIContainer_Field_Description() -----------------------------------------------
      // Setzten der Cotainer Description
      function SetEasyPickIIContainer_Field_Description(
                                                         variable i_intContainerID,
                                                         variable i_strDescription
                                                       ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intContainerID=",i_intContainerID,
               ", i_strDescription=\"",i_strDescription,"\"",
               ",...)");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intContainerID))
            return (InternalInvalidParameterError( "i_intContainerID", GetFunctionName()));
         if (!Util::IsString( i_strDescription))
            return (InternalInvalidParameterError( "i_strDescription", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_SetEasyPickIIContainer_Field_Description(i_intContainerID,
                                                                                                               i_strDescription);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetEasyPickIIContainerID_By_PositionNumber() ---------------------------------------------
      // Ermitteln der ContainerID anhand der PositionNumber
      function GetEasyPickIIContainerID_By_PositionNumber(
                                                           variable i_intRackID,
                                                           variable i_intContainerNumber,
                                                           variable & o_arrintContainerIDs[]
                                                         ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intRackID=",i_intRackID,
                                                                                ", i_intContainerNumber=",i_intContainerNumber,
                                                                                ",...)");

         o_arrintContainerIDs.SetSize(0);

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_intContainerNumber))
            return (InternalInvalidParameterError( "i_intContainerNumber", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIContainerID_By_PositionNumber(i_intRackID,
                                                                                                                 i_intContainerNumber,
                                                                                                                 o_arrintContainerIDs);


         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
         {
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",ReturnValue,
               ", o_arrintContainerIDs=", HELPER::ArrayIntToString( o_arrintContainerIDs));
         }

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetEasyPickIIContainerID_By_PositionText() -----------------------------------------------
      // Ermitteln der ContainerID anhand der PositionText
      function GetEasyPickIIContainerID_By_PositionText(
                                                         variable i_intRackID,
                                                         variable i_strPositionText,
                                                         variable & o_arrintContainerID[]
                                                       ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                                                "( i_intRackID=",i_intRackID,
                                                                                ", i_strPositionText=\"",i_strPositionText,"\"",
                                                                                ",...)");

         o_arrintContainerID.SetSize(0);

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsString( i_strPositionText))
            return (InternalInvalidParameterError( "i_strPositionText", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIContainerID_By_PositionText(i_intRackID,
                                                                                                               i_strPositionText,
                                                                                                               o_arrintContainerID);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
         {
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue,
                                  ", o_arrintContainerID=",HELPER::ArrayIntToString( o_arrintContainerID));
         }

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Colonies_RetrieveColonyNumbers() ---------------------------------------------------------
      // Holen der anzahl gefundenen Colonies
      function GetEasyPickIIColonyCount(
                  variable i_intRackID,
                  variable i_intContainerNumber,                       // 1 .. sectionsX * sectionsY
                  variable & o_intColoniesFound
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                            "( i_intRackID=",i_intRackID,
                                                            ", i_intContainerNumber=",i_intContainerNumber,",...",")");

         o_intColoniesFound = 0;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_intContainerNumber))
            return (InternalInvalidParameterError( "i_intContainerNumber", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyCount( i_intRackID,i_intContainerNumber, o_intColoniesFound);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                               " ReturnValue=",ReturnValue,
                                                               ", o_intColoniesFound=", o_intColoniesFound);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // GetEasyPickIIContainer() -----------------------------------------------------------------
      // Ermitteln der Container Informationen
      function GetEasyPickIIColonyProperties(
                  variable i_intColonyID,
                  variable& o_fltPositionX_mm,
                  variable& o_fltPositionY_mm,
                  variable& o_fltArea_mm2,
                  variable& o_fltCircularity,
                  variable& o_fltClearanceNeightbor_mm,
                  variable& o_fltClearanceBorder_mm,
                  variable& o_fltWeightedArea_pct,
                  variable& o_fltWeightedCircularity_pct,
                  variable& o_fltWeightedClearanceNeighbor_pct,
                  variable& o_fltWeightedClearanceBorder_pct,
                  variable& o_fltWeightedTotal_pct,
                  variable& o_fltColorHue,
                  variable& o_fltColorSaturation,
                  variable& o_fltColorIntensity,
                  variable& o_intPickingState,
                  variable& o_intIsExcluded,
                  variable& o_intIsGoodColony,
                  variable& o_intSortOrder,
                  variable& o_intIsEditedByUser
                  ) variable                                     // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intColonyID=", i_intColonyID,
               ",...)");

          o_fltPositionX_mm                  = 0.0;
          o_fltPositionY_mm                  = 0.0;
          o_fltArea_mm2                      = 0.0;
          o_fltCircularity                   = 0.0;
          o_fltClearanceNeightbor_mm         = 0.0;
          o_fltClearanceBorder_mm            = 0.0;
          o_fltWeightedArea_pct              = 0.0;
          o_fltWeightedCircularity_pct       = 0.0;
          o_fltWeightedClearanceNeighbor_pct = 0.0;
          o_fltWeightedClearanceBorder_pct   = 0.0;
          o_fltWeightedTotal_pct             = 0.0;
          o_fltColorHue                      = 0.0;
          o_fltColorSaturation               = 0.0;
          o_fltColorIntensity                = 0.0;
          o_intPickingState                  = 0;
          o_intIsExcluded                    = 0;
          o_intIsGoodColony                  = 0;
          o_intSortOrder                     = 0;
          o_intIsEditedByUser                = 0;


         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyProperties(
                           i_intColonyID,
                           o_fltPositionX_mm,
                           o_fltPositionY_mm,
                           o_fltArea_mm2,
                           o_fltCircularity,
                           o_fltClearanceNeightbor_mm,
                           o_fltClearanceBorder_mm,
                           o_fltWeightedArea_pct,
                           o_fltWeightedCircularity_pct,
                           o_fltWeightedClearanceNeighbor_pct,
                           o_fltWeightedClearanceBorder_pct,
                           o_fltWeightedTotal_pct,
                           o_fltColorHue,
                           o_fltColorSaturation,
                           o_fltColorIntensity,
                           o_intPickingState,
                           o_intIsExcluded,
                           o_intIsGoodColony,
                           o_intSortOrder,
                           o_intIsEditedByUser
                           );

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
               ", o_fltPositionX_mm=", o_fltPositionX_mm,
               ", o_fltPositionY_mm=", o_fltPositionY_mm,
               ", o_fltArea_mm2=", o_fltArea_mm2,
               ", o_fltCircularity=", o_fltCircularity,
               ", o_fltClearanceNeightbor_mm=", o_fltClearanceNeightbor_mm,
               ", o_fltClearanceBorder_mm=", o_fltClearanceBorder_mm,
               ", o_fltWeightedArea_pct=", o_fltWeightedArea_pct,
               ", o_fltWeightedCircularity_pct=", o_fltWeightedCircularity_pct,
               ", o_fltWeightedClearanceNeighbor_pct=", o_fltWeightedClearanceNeighbor_pct,
               ", o_fltWeightedClearanceBorder_pct=", o_fltWeightedClearanceBorder_pct,
               ", o_fltWeightedTotal_pct=", o_fltWeightedTotal_pct,
               ", o_fltColorHue=", o_fltColorHue,
               ", o_fltColorSaturation=", o_fltColorSaturation,
               ", o_fltColorIntensity=", o_fltColorIntensity,
               ", o_intPickingState=", o_intPickingState,
               ", o_intIsExcluded=", o_intIsExcluded,
               ", o_intIsGoodColony=", o_intIsGoodColony,
               ", o_intSortOrder=", o_intSortOrder,
               ", o_intIsEditedByUser=", o_intIsEditedByUser
               );

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // GetEasyPickIIColonyProperties2() -----------------------------------------------------------------
      // Ermitteln der Container Informationen
      function GetEasyPickIIColonyProperties2(
                  variable i_intColonyID,
                  variable& o_fltPositionX_mm,
                  variable& o_fltPositionY_mm,
                  variable& o_fltArea_mm2,
                  variable& o_fltCircularity,
                  variable& o_fltClearanceNeightbor_mm,
                  variable& o_fltClearanceBorder_mm,
                  variable& o_fltWeightedArea_pct,
                  variable& o_fltWeightedCircularity_pct,
                  variable& o_fltWeightedClearanceNeighbor_pct,
                  variable& o_fltWeightedClearanceBorder_pct,
                  variable& o_fltWeightedTotal_pct,
                  variable& o_fltColorHue,
                  variable& o_fltColorSaturation,
                  variable& o_fltColorIntensity,
                  variable& o_intPickingState,
                  variable& o_blnIsExcluded,
                  variable& o_blnIsGoodColony,
                  variable& o_intSortOrder,
                  variable& o_blnIsEditedByUser,
                  variable& o_strPickingDate,
                  variable& o_fltColorRed,
                  variable& o_fltColorGreen,
                  variable& o_fltColorBlue
                  ) variable                                     // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intColonyID=", i_intColonyID,
               ",...)");

          o_fltPositionX_mm = 0.0;
          o_fltPositionY_mm = 0.0;
          o_fltArea_mm2 = 0.0;
          o_fltCircularity = 0.0;
          o_fltClearanceNeightbor_mm = 0.0;
          o_fltClearanceBorder_mm = 0.0;
          o_fltWeightedArea_pct = 0.0;
          o_fltWeightedCircularity_pct = 0.0;
          o_fltWeightedClearanceNeighbor_pct = 0.0;
          o_fltWeightedClearanceBorder_pct = 0.0;
          o_fltWeightedTotal_pct = 0.0;
          o_fltColorHue = 0.0;
          o_fltColorSaturation = 0.0;
          o_fltColorIntensity = 0.0;
          o_intPickingState = 0;
          o_blnIsExcluded = hslFalse;
          o_blnIsGoodColony = hslFalse;
          o_intSortOrder = 0;
          o_blnIsEditedByUser = hslFalse;
          o_strPickingDate = "";
          o_fltColorRed = 0;
          o_fltColorGreen = 0;
          o_fltColorBlue = 0;


         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyProperties2(
                           i_intColonyID,
                           o_fltPositionX_mm,
                           o_fltPositionY_mm,
                           o_fltArea_mm2,
                           o_fltCircularity,
                           o_fltClearanceNeightbor_mm,
                           o_fltClearanceBorder_mm,
                           o_fltWeightedArea_pct,
                           o_fltWeightedCircularity_pct,
                           o_fltWeightedClearanceNeighbor_pct,
                           o_fltWeightedClearanceBorder_pct,
                           o_fltWeightedTotal_pct,
                           o_fltColorHue,
                           o_fltColorSaturation,
                           o_fltColorIntensity,
                           o_intPickingState,
                           o_blnIsExcluded,
                           o_blnIsGoodColony,
                           o_intSortOrder,
                           o_blnIsEditedByUser,
                           o_strPickingDate,
                           o_fltColorRed,
                           o_fltColorGreen,
                           o_fltColorBlue
                           );
         o_blnIsExcluded = ConvertToBoolean(o_blnIsExcluded);
         o_blnIsGoodColony = ConvertToBoolean(o_blnIsGoodColony);
         o_blnIsEditedByUser = ConvertToBoolean(o_blnIsEditedByUser);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), " ReturnValue=",ReturnValue,
               ", o_fltPositionX_mm=",o_fltPositionX_mm,
               ", o_fltPositionY_mm=", o_fltPositionY_mm,
               ", o_fltArea_mm2=", o_fltArea_mm2,
               ", o_fltCircularity=", o_fltCircularity,
               ", o_fltClearanceNeightbor_mm=", o_fltClearanceNeightbor_mm,
               ", o_fltClearanceBorder_mm=", o_fltClearanceBorder_mm,
               ", o_fltWeightedArea_pct=", o_fltWeightedArea_pct,
               ", o_fltWeightedCircularity_pct=", o_fltWeightedCircularity_pct,
               ", o_fltWeightedClearanceNeighbor_pct=", o_fltWeightedClearanceNeighbor_pct,
               ", o_fltWeightedClearanceBorder_pct=", o_fltWeightedClearanceBorder_pct,
               ", o_fltWeightedTotal_pct=", o_fltWeightedTotal_pct,
               ", o_fltColorHue=", o_fltColorHue,
               ", o_fltColorSaturation=", o_fltColorSaturation,
               ", o_fltColorIntensity=", o_fltColorIntensity,
               ", o_intPickingState=", o_intPickingState,
               ", o_blnIsExcluded=", o_blnIsExcluded,
               ", o_blnIsGoodColony=", o_blnIsGoodColony,
               ", o_intSortOrder=", o_intSortOrder,
               ", o_blnIsEditedByUser=", o_blnIsEditedByUser,
               ", o_strPickingDate=", o_strPickingDate,
               ", o_fltColorRed=", o_fltColorRed,
               ", o_fltColorGreen=", o_fltColorGreen,
               ", o_fltColorBlue=", o_fltColorBlue
               );

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------

      // Colonies_RetrieveColonyNumbers => GetEasyPickIIColonyCount
      // Colonies_RetrieveColonyPosition   (basierend auf die Reihenfolge SequenceNumber (CurrentColonyPosition)

      // SetEasyPickIIColonyPickingState() ------------------------------------------------------
      function SetEasyPickIIColonyPickingState(
                  variable i_intColonyID,
                  variable i_intPickingState
                  ) variable
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                            "( i_intColonyID=",i_intColonyID,
                                                            ", i_intPickingState=",i_intPickingState,
                                                            ")");

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intColonyID))
            return (InternalInvalidParameterError( "i_intColonyID", GetFunctionName()));
         if (!Util::IsInteger( i_intPickingState))
            return (InternalInvalidParameterError( "i_intPickingState", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_SetEasyPickIIColonyPickingState( i_intColonyID, i_intPickingState);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // Colonies_RetrieveColonyPosition() --------------------------------------------------------
      // Holen der ColonyPosition
      function GetEasyPickIIColonyPositionForColonyNumber(
            variable i_intRackID,     // Welche EasyPickRackID
            variable i_intChannelNumber,      // Welcher Kanal (1-x)
            variable i_intContainerNumber,     // 1 .. ContainersX * ContainersY
            variable i_intColonyNumber,       // Welche Colonie-Nummer
            variable & o_intColonyID, // Rueckgabe EasyPickColonyID
            variable & o_fltPositionX_mm,        // Ausgabe XPosition
            variable & o_fltPositionY_mm,        // Ausgabe YPosition
            variable & o_fltWeightedTotal_pct      // LoadingTotal Wert (Qualitaetswert)
          ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                                            "( i_intRackID=",i_intRackID,
                                                            ", i_intChannelNumber=",i_intChannelNumber,
                                                            ", i_intContainerNumber=",i_intContainerNumber,
                                                            ", i_intColonyNumber=",i_intColonyNumber,",...",")");

         o_intColonyID = _DATABASE_RETURN_VALUE_NO_ID_FOUND;
         o_fltPositionX_mm                = 0.0;
         o_fltPositionY_mm                = 0.0;
         o_fltWeightedTotal_pct             = 0.0;

         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_intChannelNumber))
            return (InternalInvalidParameterError( "i_intChannelNumber", GetFunctionName()));
         if (!Util::IsInteger( i_intContainerNumber))
            return (InternalInvalidParameterError( "i_intContainerNumber", GetFunctionName()));
         if (!Util::IsInteger( i_intColonyNumber))
            return (InternalInvalidParameterError( "i_intColonyNumber", GetFunctionName()));

         ReturnValue = _EASYPICKII_COM_Application_Connection.Database_GetEasyPickIIColonyPositionFromColonyNumber(
                                                                  i_intRackID,
                                                                  i_intChannelNumber,
                                                                  i_intContainerNumber,
                                                                  i_intColonyNumber,
                                                                  o_intColonyID,
                                                                  o_fltPositionX_mm,
                                                                  o_fltPositionY_mm,
                                                                  o_fltWeightedTotal_pct);

         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," ReturnValue=",ReturnValue,
                                                               ", o_intColonyID=",o_intColonyID,
                                                               ", o_fltPositionX_mm=",o_fltPositionX_mm,
                                                               ", o_fltPositionY_mm=",o_fltPositionY_mm,
                                                               ", o_fltWeightedTotal_pct=",o_fltWeightedTotal_pct);

         return (ReturnValue);
      }
      // ------------------------------------------------------------------------------------------


      // Colonies_RetrieveColonyPosition() --------------------------------------------------------
      // Holen der ColonyPosition
      function RetrieveColonyPositions(
            variable i_intRackID,
            variable i_arrintMaxNumberOfColoniesToPick[],
            variable i_strChannelPattern,
            variable& o_strUsedChannelPattern,
            variable& o_intUsedNumberOfColonies,
            variable& o_intTotalNumberOfColonies,
            variable& o_arrintColonyIDs[],
            variable& o_arrintContainerNumbers[],
            variable& o_arrfltPositionX_mm[],
            variable& o_arrfltPositionY_mm[]
          ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                             "( i_intRackID= ",i_intRackID,
                                             ", i_arrintMaxNumberOfColoniesToPick= ", HELPER::ArrayIntToString( i_arrintMaxNumberOfColoniesToPick),
                                             ", i_strChannelPattern= \"",i_strChannelPattern, "\"",
                                             ",...",")");

         o_strUsedChannelPattern = "";
         o_intUsedNumberOfColonies                = 0;
         o_intTotalNumberOfColonies               = 0;


         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsString( i_strChannelPattern))
            return (InternalInvalidParameterError( "i_strChannelPattern", GetFunctionName()));

            ReturnValue = _EASYPICKII_COM_Application_Connection.Database_RetrieveColonyPositions(
                               i_intRackID,
                               i_arrintMaxNumberOfColoniesToPick,
                               i_strChannelPattern,
                               o_strUsedChannelPattern,
                               o_intUsedNumberOfColonies,
                               o_intTotalNumberOfColonies,
                               o_arrintColonyIDs,
                               o_arrintContainerNumbers,
                               o_arrfltPositionX_mm,
                               o_arrfltPositionY_mm );


         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
         {
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                             " ReturnValue=",ReturnValue,
                                             ", o_strUsedChannelPattern= \"",o_strUsedChannelPattern, "\"",
                                             ", o_intUsedNumberOfColonies= ",o_intUsedNumberOfColonies,
                                             ", o_intTotalNumberOfColonies= ",o_intTotalNumberOfColonies );
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrintColonyIDs= ", HELPER::ArrayIntToString( o_arrintColonyIDs));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrintContainerNumbers= ", HELPER::ArrayIntToString( o_arrintContainerNumbers));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrfltPositionX_mm= ", HELPER::ArrayFltToString( o_arrfltPositionX_mm));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrfltPositionY_mm= ", HELPER::ArrayFltToString( o_arrfltPositionY_mm));
         }

         return (ReturnValue);
      } // function RetrieveColonyPositions
      // ------------------------------------------------------------------------------------------


      // Colonies_RetrieveColonyPosition() --------------------------------------------------------
      // Get colony positions.
      // i_intSortMode: Defines algorithm for the sequence of positions. See constants in namespace COLONYPOSITIONS_SORTMODE
      function RetrieveColonyPositions2(
            variable i_intRackID,
            variable i_arrintMaxNumberOfColoniesToPick[],
            variable i_intSortMode,
            variable i_strChannelPattern,
            variable& o_strUsedChannelPattern,
            variable& o_intUsedNumberOfColonies,
            variable& o_intTotalNumberOfColonies,
            variable& o_arrintColonyIDs[],
            variable& o_arrintContainerNumbers[],
            variable& o_arrfltPositionX_mm[],
            variable& o_arrfltPositionY_mm[]
          ) variable                              // Return: ReturnValue
      {
         variable ReturnValue;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intRackID= ",i_intRackID,
               ", i_arrintMaxNumberOfColoniesToPick= ", HELPER::ArrayIntToString( i_arrintMaxNumberOfColoniesToPick),
               ", i_intSortMode= ", i_intSortMode,
               ", i_strChannelPattern= \"",i_strChannelPattern, "\"",
               ",...",")");

         o_strUsedChannelPattern    = "";
         o_intUsedNumberOfColonies  = 0;
         o_intTotalNumberOfColonies = 0;


         if (_EASYPICKII_COM_Application_Connection_UsedFlag==hslFalse)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         if (!Util::IsInteger( i_intRackID))
            return (InternalInvalidParameterError( "i_intRackID", GetFunctionName()));
         if (!Util::IsInteger( i_intSortMode))
            return (InternalInvalidParameterError( "i_intSortMode", GetFunctionName()));
         if (!Util::IsString( i_strChannelPattern))
            return (InternalInvalidParameterError( "i_strChannelPattern", GetFunctionName()));

            ReturnValue = _EASYPICKII_COM_Application_Connection.Database_RetrieveColonyPositions2(
                               i_intRackID,
                               i_arrintMaxNumberOfColoniesToPick,
                               i_intSortMode,
                               i_strChannelPattern,
                               o_strUsedChannelPattern,
                               o_intUsedNumberOfColonies,
                               o_intTotalNumberOfColonies,
                               o_arrintColonyIDs,
                               o_arrintContainerNumbers,
                               o_arrfltPositionX_mm,
                               o_arrfltPositionY_mm );


         if (ReturnValue != ERROR::_NONE && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( ReturnValue, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
         {
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                                             " ReturnValue=",ReturnValue,
                                             ", o_strUsedChannelPattern= \"",o_strUsedChannelPattern, "\"",
                                             ", o_intUsedNumberOfColonies= ",o_intUsedNumberOfColonies,
                                             ", o_intTotalNumberOfColonies= ",o_intTotalNumberOfColonies );
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrintColonyIDs= ", HELPER::ArrayIntToString( o_arrintColonyIDs));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrintContainerNumbers= ", HELPER::ArrayIntToString( o_arrintContainerNumbers));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrfltPositionX_mm= ", HELPER::ArrayFltToString( o_arrfltPositionX_mm));
            FormatTrace(  FMT_SRC, FMT_ACTION, FMT_STATUS, "    o_arrfltPositionY_mm= ", HELPER::ArrayFltToString( o_arrfltPositionY_mm));
         }

         return (ReturnValue);
      } // function RetrieveColonyPositions
      // ------------------------------------------------------------------------------------------

      // ------------------------------------------------------------------------------------------
      function SelectEasyPickIIRack(
                  variable& o_intRackID
                  ) variable
      {
         variable intErrorCode;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "(...)");

         o_intRackID = -1;

         if (!_EASYPICKII_COM_Application_Connection_UsedFlag)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " The Application is not running!");
            return (ERROR::GENERAL::_APPLICATION);
         }

         intErrorCode = _EASYPICKII_COM_Application_Connection.Database_SelectEasyPickIIRack(
                           o_intRackID);

         if (intErrorCode && gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
            InternalTraceError( intErrorCode, GetFunctionName());
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " ReturnValue=",intErrorCode,
               ", o_intRackID=", o_intRackID);

         return (intErrorCode);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace DATABASE

   namespace HELPER
   {

      // Converts an integer value to a string of specified length with leading zeros.
      //
      // Args:
      //    i_intNumber (int): The integer to convert.
      //    i_intLength (int): The number of characters in the result.
      //
      // Returns:
      //    (string): The string representation of value.
      static function StrIStrWithLeadingZeros(
                        variable i_intValue,
                        variable i_intLength
                        ) variable
      {
         variable strNullen;

         strNullen = "000000000000000000" + StrIStr( i_intValue);
         strNullen = StrRight(strNullen, i_intLength);

         return (strNullen);
      }
      // ------------------------------------------------------------------------------------------

   } // namespace HELPER

   // ------------------------------------------------------------------------------------------
   namespace MLSTAR
   {
      // Adjust Channel X-Offset zur Labware
      static const variable _ADJUST_CHANNEL_LABWARE_X_OFFSET   (0.0);   // in mm
      // Adjust Channel Y-Offset zur Labware
      static const variable _ADJUST_CHANNEL_LABWARE_Y_OFFSET   (0.0);   // in mm
      // Adjust Channel Z-Offset zur Labware
      static const variable _ADJUST_CHANNEL_LABWARE_Z_OFFSET   (6.0);   // in mm


      // Mit welchem Faktor wird das PWM-Signal verkleinert, dass nur maximal 24V auf dem Ausgang ist
      static const variable _light_CAMERA_CHANNEL_PWM_Factor    (0.58);
      static       variable _light_CAMERA_CHANNEL_PWM_IsOn      (hslFalse);

      // Mit welchem Faktor wird das PWM-Signal verkleinert, dass nur maximal 24V auf dem Ausgang ist
      static const variable _light_DIV2_PWM_Factor              (0.58);
      // DIV2 PWM-Nummer
      static const variable _light_DIV2_PWM1_Number             ("on1");
      static       variable _light_DIV2_PWM1_IsOn               (hslFalse);
      static const variable _light_DIV2_PWM2_Number             ("on2");
      static       variable _light_DIV2_PWM2_IsOn               (hslFalse);

      // Mit welchem Faktor wird das PWM-Signal verkleinert, dass nur maximal 24V auf dem Ausgang ist
      static const variable _light_DIV3_PWM_Factor              (0.58);
      // DIV3 PWM-Nummer
      static const variable _light_DIV3_PWM3_Number             ("on3");
      static       variable _light_DIV3_PWM3_IsOn               (hslFalse);
      static const variable _light_DIV3_PWM4_Number             ("on4");
      static       variable _light_DIV3_PWM4_IsOn               (hslFalse);

      static function ExecFW_Cmd(
                                  device & ML_STAR,
                                  variable cmd,
                                  variable prm
                                ) variable []
      {
         variable tmpVal[];

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(",
                        "cmd=\"",cmd,"\"",
                        ",prm=\"",prm,"\"",
                        ")");

         tmpVal = ML_STAR.FirmwareCommand( "5b484f0a_de4d_4e9a_bb4a9045f08b295c" );

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),"(", "Error Code=\"",tmpVal.GetAt(3),"\")");

         return (tmpVal);
      } // end of ExecFW_Cmd()

      // ---------------------------------------------------------------
      function Light_On(
                         device & ML_STAR,       // Device
                         variable i_intLightSource,  // PWM number and DIV2 or DIV3 connector
                         variable i_fltLightIntensity_pct       // Lichtstaerke
                       ) variable
      {
         variable rc[];
         variable er("");
         variable percentStr;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intLightSource=",i_intLightSource,
               ", i_fltLightIntensity_pct=",i_fltLightIntensity_pct,
               ")");


         if (!Util::IsInteger( i_intLightSource))
            return (InternalInvalidParameterError( "i_intLightSource", GetFunctionName()));
         if (!Util::IsNumber( i_fltLightIntensity_pct))
            return (InternalInvalidParameterError( "i_fltLightIntensity_pct", GetFunctionName()));

         if (i_fltLightIntensity_pct > 100) i_fltLightIntensity_pct = 100;
         if (i_fltLightIntensity_pct < 0)   i_fltLightIntensity_pct = 0;

         if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM1)
         {
            percentStr = HELPER::StrIStrWithLeadingZeros(IVal(FStr( i_fltLightIntensity_pct*_light_DIV2_PWM_Factor)),3);
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OS",_light_DIV2_PWM1_Number+"od01"+"os"+percentStr+"oe"+percentStr);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV2_PWM1_IsOn = hslTrue;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM2)
         {
            percentStr = HELPER::StrIStrWithLeadingZeros(IVal(FStr( i_fltLightIntensity_pct*_light_DIV2_PWM_Factor)),3);
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OS",_light_DIV2_PWM2_Number+"od01"+"os"+percentStr+"oe"+percentStr);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV2_PWM2_IsOn = hslTrue;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM3)
         {
            percentStr = HELPER::StrIStrWithLeadingZeros(IVal(FStr( i_fltLightIntensity_pct*_light_DIV3_PWM_Factor)),3);
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OS",_light_DIV3_PWM3_Number+"od01"+"os"+percentStr+"oe"+percentStr);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV3_PWM3_IsOn = hslTrue;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM4)
         {
            percentStr = HELPER::StrIStrWithLeadingZeros(IVal(FStr( i_fltLightIntensity_pct*_light_DIV3_PWM_Factor)),3);
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OS",_light_DIV3_PWM4_Number+"od01"+"os"+percentStr+"oe"+percentStr);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
                     FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                        " Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV3_PWM4_IsOn = hslTrue;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_CAMERA_CANNEL)
         {
            percentStr = HELPER::StrIStrWithLeadingZeros(IVal(FStr( i_fltLightIntensity_pct*_light_CAMERA_CHANNEL_PWM_Factor)),3);
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"ICCA","ca"+percentStr);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
                     FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                        " Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_CAMERA_CHANNEL_PWM_IsOn = hslTrue;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_NO_LIGHT)
         {
         }
         else
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " Instrument error: ","No light source selected");
            return (ERROR::GENERAL::_MLSTAR);
         }

         return (ERROR::_NONE);
      }

      // ---------------------------------------------------------------
      function Light_Off(
                          device & ML_STAR,
                          variable i_intLightSource
                        ) variable
      {
         variable rc[];
         variable er("");

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               "( i_intLightSource=",i_intLightSource,
               ")");

         if (!Util::IsInteger( i_intLightSource))
            return (InternalInvalidParameterError( "i_intLightSource", GetFunctionName()));

         if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM1)
         {
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OR",_light_DIV2_PWM1_Number);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV2_PWM1_IsOn = hslFalse;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM2)
         {
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OR",_light_DIV2_PWM2_Number);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV2_PWM2_IsOn = hslFalse;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM3)
         {
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OR",_light_DIV3_PWM3_Number);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV3_PWM3_IsOn = hslFalse;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM4)
         {
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"X0OR",_light_DIV3_PWM4_Number);
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_DIV3_PWM4_IsOn = hslFalse;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_CAMERA_CANNEL)
         {
            if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_OFF)
            {
               rc = ExecFW_Cmd(ML_STAR,"ICCB","");
               er = rc.GetAt(3);
               if (er != "er00/00" && er != "er00")
               {
                  if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
                  return (ERROR::GENERAL::_MLSTAR);
               }
            }
            _light_CAMERA_CHANNEL_PWM_IsOn = hslFalse;
         }
         else if (i_intLightSource == EASYPICKII_HELPER::LIGHTSOURCE::_NO_LIGHT)
         {
         }
         else
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ","No light source selected");
            return (ERROR::GENERAL::_MLSTAR);
         }

         return (ERROR::_NONE);
      }
      // ---------------------------------------------------------------

      // ---------------------------------------------------------------
      function Light_Off_All(
                              device & ML_STAR       // Device
                            ) variable
      {
         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(), "(",
                                                                                ")");

         if (_light_DIV2_PWM1_IsOn == hslTrue)
         {
            Light_Off(ML_STAR,EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM1);
         }
         if (_light_DIV2_PWM2_IsOn == hslTrue)
         {
            Light_Off(ML_STAR,EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV2_PWM2);
         }
         if (_light_DIV3_PWM3_IsOn == hslTrue)
         {
            Light_Off(ML_STAR,EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM3);
         }
         if (_light_DIV3_PWM4_IsOn == hslTrue)
         {
            Light_Off(ML_STAR,EASYPICKII_HELPER::LIGHTSOURCE::_MLSTAR_DIV3_PWM4);
         }
         if (_light_CAMERA_CHANNEL_PWM_IsOn == hslTrue)
         {
            Light_Off(ML_STAR,EASYPICKII_HELPER::LIGHTSOURCE::_CAMERA_CANNEL);
         }

         return (ERROR::_NONE);
      }
      // ---------------------------------------------------------------

      // ---------------------------------------------------------------
      function AdjustChannel(
                  device & ML_STAR,
                  variable i_intChannelNumber,
                  variable i_strLightTableAdjustPositionLabewareID,
                  variable & o_fltXOffset_mm,
                  variable & o_fltYOffset_mm,
                  variable & o_fltZOffset_mm
                  ) variable
      {
         variable rc[];
         variable er("");
         variable xPos,yPos,zPos;
         variable xPosFirmware,yPosFirmware,zPosFirmware;

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
                        "(i_intChannelNumber=",i_intChannelNumber,
                        ",i_strLightTableAdjustPositionLabewareID=\"",i_strLightTableAdjustPositionLabewareID,"\"",
                        ",...)");

         o_fltXOffset_mm=0.0;
         o_fltYOffset_mm=0.0;
         o_fltZOffset_mm=0.0;

         if (_EASYPICKII_SimulationMode == _SIMULATION_MODE_ON)
         {
            return (ERROR::_NONE);
         }

         // Ermitteln der Koordinaten
         if (HELPER::LABWARE::GetPositionCoordinates_Center_by_Labware(ML_STAR, i_strLightTableAdjustPositionLabewareID, xPos, yPos, zPos)!=ERROR::_NONE)
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL) FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," Labware error: Labware \"",i_strLightTableAdjustPositionLabewareID,"\" not found or cannot get the coordinates!");
            return (ERROR::GENERAL::_LIBRARY);
         }

         // Korrektur anhand der Labware fuer den C0JR-Befehl
         xPosFirmware=MthRound((xPos + _ADJUST_CHANNEL_LABWARE_X_OFFSET) * 10,0);
         yPosFirmware=MthRound((yPos + _ADJUST_CHANNEL_LABWARE_Y_OFFSET) * 10,0);
         zPosFirmware=MthRound((zPos + _ADJUST_CHANNEL_LABWARE_Z_OFFSET) * 10,0);

         // Befehl C0JP(maximum y range for pip.channel pn) ----------------------------
         rc = ExecFW_Cmd( ML_STAR, "C0JP", "pn" + HELPER::StrIStrWithLeadingZeros( i_intChannelNumber, 2));
         er = rc.GetAt(3);
         if (er != "er00/00" && er != "er00")
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName()," Instrument error: ",er);
            return (ERROR::GENERAL::_MLSTAR);
         }

         // Befehl C0JR(Teach rack using pip.channel pn) -------------------------------
         rc = ExecFW_Cmd(ML_STAR,"C0JR",
            "pn"+HELPER::StrIStrWithLeadingZeros(i_intChannelNumber,2)+
            "xs"+HELPER::StrIStrWithLeadingZeros(xPosFirmware,5)+
            "yj"+HELPER::StrIStrWithLeadingZeros(yPosFirmware,4)+
            "zj"+HELPER::StrIStrWithLeadingZeros(zPosFirmware,4)+
            "te2800");
         er = rc.GetAt(3);
         if (StrMid(er,0,7) != "er00/00" && StrMid(er,0,4) != "er00")
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " Instrument error: ",er);
            return (ERROR::GENERAL::_MLSTAR);
         }

         // Berechnen des Offsets
         o_fltXOffset_mm = MthRound(xPos - (StrFVal(StrMid(er,9,6))/10.0)    ,4);
         o_fltYOffset_mm = MthRound((StrFVal(StrMid(er,17,5)) / 10.0) - yPos ,4);
         o_fltZOffset_mm = MthRound(zPos - (StrFVal(StrMid(er,24,5))/10.0)   ,4);

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName(),
               " o_fltXOffset_mm=",o_fltXOffset_mm,
               ",o_fltYOffset_mm=",o_fltYOffset_mm,
               ",o_fltZOffset_mm=",o_fltZOffset_mm);

         // Befehl C0ZA(Pip. Kanle in Z auf Ueberfahrhhe) ----------------------------
         rc = ExecFW_Cmd( ML_STAR, "C0ZA","");
         er = rc.GetAt(3);
         if (er != "er00/00" && er != "er00")
         {
            if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_NORMAL)
               FormatTrace( FMT_SRC, FMT_ACTION, FmtStatus::Error, GetFunctionName(),
                  " Instrument error: ",er);
            return (ERROR::GENERAL::_MLSTAR);
         }

         if (gEasyPickII_intTraceLevel >= _TRACE_LEVEL_FULL)
            FormatTrace( FMT_SRC, FMT_ACTION, FMT_STATUS, GetFunctionName()," Function ended! ");
         return (ERROR::_NONE);
      }
      // ---------------------------------------------------------------

   } // namespace MLSTAR

} // namespace EASYPICKII

#endif
// $$author=ljegher$$valid=1$$time=2016-07-07 23:52$$checksum=e49ef4c5$$length=084$$